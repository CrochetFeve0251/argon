import * as Argon from '../../src/argon';
window['Argon'] = Argon;
var app = window['app'] = Argon.init();
var scene = window['scene'] = new THREE.Scene();
var camera = window['camera'] = new THREE.PerspectiveCamera();
var user = window['user'] = new THREE.Object3D();
var stage = window['stage'] = new THREE.Object3D;
var center = window['center'] = new THREE.Object3D;
scene.add(camera);
scene.add(user);
scene.add(stage);
stage.add(center);
var renderer = new THREE.WebGLRenderer({
    alpha: true,
    logarithmicDepthBuffer: true
});
app.view.setLayers([
    { source: renderer.domElement }
]);
var geometry = new THREE.SphereGeometry(0.1, 32, 32);
var mat = new THREE.MeshBasicMaterial({ color: 0xff0000 });
var posXSphere = new THREE.Mesh(geometry, mat);
posXSphere.position.x = 1;
center.add(posXSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xffaaaa });
var negXSphere = new THREE.Mesh(geometry, mat);
negXSphere.position.x = -1;
center.add(negXSphere);
mat = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
var posYSphere = new THREE.Mesh(geometry, mat);
posYSphere.position.y = 1;
center.add(posYSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xaaffaa });
var negYSphere = new THREE.Mesh(geometry, mat);
negYSphere.position.y = -1;
center.add(negYSphere);
mat = new THREE.MeshBasicMaterial({ color: 0x0000ff });
var posZSphere = new THREE.Mesh(geometry, mat);
posZSphere.position.z = 1;
center.add(posZSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xaaaaff });
var negZSphere = new THREE.Mesh(geometry, mat);
negZSphere.position.z = -1;
center.add(negZSphere);
var axisHelper = new THREE.AxisHelper(0.1);
center.add(axisHelper);
// var textShapes = THREE.FontUtils.generateShapes( "PosZ", options );
// var text = new THREE.ShapeGeometry( textShapes );
// var textMesh = new THREE.Mesh( text, new THREE.MeshBasicMaterial( { color: 0xff0000 } ) ) ;
// scene.add(textMesh);
app.vuforia.init({
    encryptedLicenseData: "-----BEGIN PGP MESSAGE-----\nComment: GPGTools - https://gpgtools.org\n\nhQIMA1AUQCNdm8lhAQ/+Kam6naTGpo6C2EkYOWTKVmeLa6lD4epaRrH3ZnhOHm5z\ndpFmTehxe+A/J/7/68EvEGDPfuV4cqHTXNuvlAvY1K625/i8EfNrx+nPL0umap5E\nWaYRnLNF6MlC1Pu8aLY8c8vd/ZA9h2Zk8P4t0C/uOayJBZk0BhKRlOgCJbjOd7/X\nEMPOD3XtFUP8T13Kpqb/A8cyIRTOowm8yaj4PajUCAlOWSYKYRcXM5yg/5t7XTdi\n3iURgidFbWowbnqyFmOKxAxqRBoXPGYEDmK8IgOgYmR7C5pVAmWDK8ZcsTn2YC0T\nJhYUSQvRA2CszK9UMEoOh2rqE8RHZY4MuVPm1QNC1j4yP1FSDZvfcJdOTbTeBCci\n6ATCARma+roA3xtbzPVWhjc8DGtlRIJqj0+cRjK8RMzIMbBPGlTZihgt7W0sifa/\nm38zAlE4Be5Omg+kJ76kyXph+SIj0gqBl5rG34O4n4KgCBooipjWnAfzwKJknBiX\n74ex99LZf/VfijCjDKkUpiyrHHOkWHFDeolWTZVmj3D6HBqUaCMGp3ObQ0AGA+tt\n/BuRohIHk1zvST66FzBoFx2+fctZm7c+VItAoyW/+IVuulFCsoQdE59fF81MaMan\nRw1MNC6d1uemIZI/xp+ilxbpeloypyrWa6ZLzlScOv7//C5bowZgjmxCfbY7SYHS\n6QFyUllcKIYGoVOMX30ZrdaQMU8177nnMik8Ivr5zkgu9FsKkwi0MH4XTP4Jp8zk\neR4f+bzZmxitTLYoaJFnkmxdzyHTsIXgOOtndTh18+uSgvEz+oewrvawQCTXJKXw\nBwYk7wAvMlFywMM/B+H4kvBOThqG7je2S3UitW1walSwq+P8p/v2UzIxy+yGTzlz\n0eKmfbx2b2+6r76hDVRt0XiAuVKXq8Erndx20VkRZj3MBOgus3XmvbCgORn0w5F/\n2sg6kkNDrAI7aUq83EFMuDr3A6ABbt3C6cEPEB1sLhsqhnLTvkHTr6J7Br+wI+2f\nelT3x15oPUAjnDQR7kC77cmZ8U5o/R2nYOlPzDSyX34cV3z176hqssQa3l/ebh+4\nuuMHiecut/s2FVACrizVtEI+Z9I73iURwD9DrdRuJKYMdKoYDqoM43VdIZfNc3Ec\nj7SKC/LSpOJL8YQlLoKLtdAjCYrYhDgycAKKpTw9Kv6wbSQ3qxOEUMrxK2I30NaA\n9tuzf15WZ+TathGTIL7VqLKS4UPK57zvrdqneB6Xlj4CABMIL3ZmgGuJPr8WSJSu\nxMTXBowqC4eNuwUGtQtsy+7xYkxOLs/NVn2nNNb6NlEaZX0QUhqgW+t5j3d4SRry\nkDYZIbq+RqPwaZhg0hXpT5Fwz97y4Z5NyjAu44kiYAK2Du0Vyi1e0PMtW2ja4ZH0\n=d+oG\n-----END PGP MESSAGE-----"
}).then(function (api) {
    api.objectTracker.createDataSetFromURL('dataset/StonesAndChips.xml').then(function (id) {
        api.objectTracker.loadDataSet(id).then(function (trackables) {
            var stonesEntity = app.context.subscribeToEntityById(trackables['stones'].id);
            var stonesObject = new THREE.Object3D;
            scene.add(stonesObject);
            var boxGeometry = new THREE.BoxGeometry(50, 50, 50);
            var material = new THREE.MeshNormalMaterial();
            material.side = THREE.DoubleSide;
            var box = new THREE.Mesh(boxGeometry, material);
            box.position.z = 25;
            box.position.y = 50;
            var axisHelper = new THREE.AxisHelper(10);
            box.add(axisHelper);
            console.log('Subscribes to stones trackable with id ' + trackables['stones'].id);
            app.context.updateEvent.addEventListener(function () {
                var stonesPose = app.context.getEntityPose(stonesEntity);
                if (stonesPose.status & Argon.PoseStatus.KNOWN) {
                    stonesObject.position.copy(stonesPose.position);
                    stonesObject.quaternion.copy(stonesPose.orientation);
                    stonesObject.add(box);
                }
                else {
                    stonesObject.remove(box);
                }
            });
        });
        api.objectTracker.activateDataSet(id);
    });
});
// On first update event, set the scene center based on the initial user height 
app.updateEvent.onNext(function () {
    var userStagePose = app.context.getEntityPose(app.context.user, app.context.stage);
    var userHeightOnStage = userStagePose.position.y;
    center.position.y = userHeightOnStage;
});
// On every update event, update user and stage pose
app.updateEvent.addEventListener(function () {
    var userPose = app.context.getEntityPose(app.context.user);
    user.position.copy(userPose.position);
    user.quaternion.copy(userPose.orientation);
    var stagePose = app.context.getEntityPose(app.context.stage);
    stage.position.copy(stagePose.position);
    stage.quaternion.copy(stagePose.orientation);
});
app.renderEvent.addEventListener(function () {
    // css renderer, if used:
    // const viewport = app.view.viewport;
    // cssRenderer.setSize(viewport.width, viewport.height);
    renderer.setSize(app.view.renderWidth, app.view.renderHeight, false);
    for (var _i = 0, _a = app.view.subviews; _i < _a.length; _i++) {
        var subview = _a[_i];
        camera.position.copy(subview.pose.position);
        camera.quaternion.copy(subview.pose.orientation);
        camera.projectionMatrix.fromArray(subview.frustum.projectionMatrix);
        var _b = subview.renderViewport, x = _b.x, y = _b.y, width = _b.width, height = _b.height;
        renderer.setViewport(x, y, width, height);
        renderer.setScissor(x, y, width, height);
        renderer.setScissorTest(true);
        renderer.render(scene, camera);
        // let {x,y,width,height} = subview.viewport;
        // cssRenderer.setViewport(x,y,width,height, subview.index)
    }
});
// // creating 6 divs to indicate the x y z positioning
// const divXpos = document.createElement('div')
// const divXneg = document.createElement('div')
// const divYpos = document.createElement('div')
// const divYneg = document.createElement('div')
// const divZpos = document.createElement('div')
// const divZneg = document.createElement('div')
// // programatically create a stylesheet for our direction divs
// // and add it to the document
// const style = document.createElement("style");
// style.type = 'text/css';
// document.head.appendChild(style);
// const sheet = <CSSStyleSheet>style.sheet;
// sheet.insertRule(`
//     .direction {
//         opacity: 0.5;
//         width: 100px;
//         height: 100px;
//         border-radius: 50%;
//         line-height: 100px;
//         fontSize: 20px;
//         text-align: center;
//     }
// `, 0);
// // Put content in each one  (should do this as a couple of functions)
// // for X
// divXpos.className = 'direction'
// divXpos.style.backgroundColor = "red"
// divXpos.innerText = "Pos X = East"
// divXneg.className = 'direction'
// divXneg.style.backgroundColor = "red"
// divXneg.innerText = "Neg X = West"
// // for Y
// divYpos.className = 'direction'
// divYpos.style.backgroundColor = "blue"
// divYpos.innerText = "Pos Y = Up"
// divYneg.className = 'direction'
// divYneg.style.backgroundColor = "blue"
// divYneg.innerText = "Neg Y = Down"
// //for Z
// divZpos.className = 'direction'
// divZpos.style.backgroundColor = "green"
// divZpos.innerText = "Pos Z = South"
// divZneg.className = 'direction'
// divZneg.style.backgroundColor = "green"
// divZneg.innerText = "Neg Z = North"
// // create 6 CSS3DObjects in the scene graph
// const cssObjectXpos = new THREE.CSS3DObject(divXpos)
// const cssObjectXneg = new THREE.CSS3DObject(divXneg)
// const cssObjectYpos = new THREE.CSS3DObject(divYpos)
// const cssObjectYneg = new THREE.CSS3DObject(divYneg)
// const cssObjectZpos = new THREE.CSS3DObject(divZpos)
// const cssObjectZneg = new THREE.CSS3DObject(divZneg)
// // the width and height is used to align things.
// cssObjectXpos.position.x = 200.0
// cssObjectXpos.rotation.y = - Math.PI / 2
// cssObjectXneg.position.x = -200.0
// cssObjectXneg.rotation.y = Math.PI / 2
// // for Y
// cssObjectYpos.position.y = 200.0
// cssObjectYpos.rotation.x = Math.PI / 2
// cssObjectYneg.position.y = - 200.0
// cssObjectYneg.rotation.x = - Math.PI / 2
// // for Z
// cssObjectZpos.position.z = 200.0
// cssObjectZpos.rotation.y = Math.PI
// cssObjectZneg.position.z = -200.0
// //no rotation need for this one
// userLocation.add(cssObjectXpos)
// userLocation.add(cssObjectXneg)
// userLocation.add(cssObjectYpos)
// userLocation.add(cssObjectYneg)
// userLocation.add(cssObjectZpos)
// userLocation.add(cssObjectZneg)
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhhbXBsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImV4YW1wbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEtBQUssTUFBTSxpQkFBaUIsQ0FBQTtBQVN4QyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDO0FBRXhCLElBQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7QUFFekMsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQ2xELElBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO0FBQ2hFLElBQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUNuRCxJQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDO0FBQ25ELElBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUM7QUFFckQsS0FBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNsQixLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2hCLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7QUFFakIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUVsQixJQUFNLFFBQVEsR0FBRyxJQUFJLEtBQUssQ0FBQyxhQUFhLENBQUM7SUFDckMsS0FBSyxFQUFFLElBQUk7SUFDWCxzQkFBc0IsRUFBRSxJQUFJO0NBQy9CLENBQUMsQ0FBQztBQUVILEdBQUcsQ0FB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QyxVQUFVO0FBQ1Ysa0NBQWtDO0FBQ2xDLDBDQUEwQztBQUMxQyxzQ0FBc0M7QUFFdEMsa0NBQWtDO0FBQ2xDLDBDQUEwQztBQUMxQyxzQ0FBc0M7QUFFdEMsOENBQThDO0FBQzlDLHVEQUF1RDtBQUN2RCx1REFBdUQ7QUFDdkQsdURBQXVEO0FBQ3ZELHVEQUF1RDtBQUN2RCx1REFBdUQ7QUFDdkQsdURBQXVEO0FBRXZELG1EQUFtRDtBQUNuRCxtQ0FBbUM7QUFDbkMsMkNBQTJDO0FBRTNDLG9DQUFvQztBQUNwQyx5Q0FBeUM7QUFFekMsV0FBVztBQUNYLG1DQUFtQztBQUNuQyx5Q0FBeUM7QUFFekMscUNBQXFDO0FBQ3JDLDJDQUEyQztBQUUzQyxXQUFXO0FBQ1gsbUNBQW1DO0FBQ25DLHFDQUFxQztBQUVyQyxvQ0FBb0M7QUFDcEMsa0NBQWtDO0FBRWxDLGtDQUFrQztBQUNsQyxrQ0FBa0M7QUFDbEMsa0NBQWtDO0FBQ2xDLGtDQUFrQztBQUNsQyxrQ0FBa0M7QUFDbEMsa0NBQWtDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQXJnb24gZnJvbSAnLi4vLi4vc3JjL2FyZ29uJ1xuLy8gaW1wb3J0ICogYXMgQXJnb24gZnJvbSAnQGFyZ29uanMvYXJnb24nXG4vLyBpbXBvcnQgKiBhcyBBcmdvbiBmcm9tICcuLi9kaXN0L3NyYy9hcmdvbidcblxuaW1wb3J0IF9fVEhSRUUgZnJvbSAndGhyZWUnO1xuZGVjbGFyZSBnbG9iYWwge1xuICBjb25zdCBUSFJFRTogdHlwZW9mIF9fVEhSRUU7XG59XG5cbndpbmRvd1snQXJnb24nXSA9IEFyZ29uO1xuXG5jb25zdCBhcHAgPSB3aW5kb3dbJ2FwcCddID0gQXJnb24uaW5pdCgpO1xuXG5jb25zdCBzY2VuZSA9IHdpbmRvd1snc2NlbmUnXSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuY29uc3QgY2FtZXJhID0gd2luZG93WydjYW1lcmEnXSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSgpO1xuY29uc3QgdXNlciA9IHdpbmRvd1sndXNlciddID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG5jb25zdCBzdGFnZSA9IHdpbmRvd1snc3RhZ2UnXSA9IG5ldyBUSFJFRS5PYmplY3QzRDtcbmNvbnN0IGNlbnRlciA9IHdpbmRvd1snY2VudGVyJ10gPSBuZXcgVEhSRUUuT2JqZWN0M0Q7XG5cbnNjZW5lLmFkZChjYW1lcmEpO1xuc2NlbmUuYWRkKHVzZXIpO1xuc2NlbmUuYWRkKHN0YWdlKTtcblxuc3RhZ2UuYWRkKGNlbnRlcik7IFxuXG5jb25zdCByZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKHsgXG4gICAgYWxwaGE6IHRydWUsIFxuICAgIGxvZ2FyaXRobWljRGVwdGhCdWZmZXI6IHRydWVcbn0pO1xuXG5hcHAudmlldy5zZXRMYXllcnMoW1xuICAgIHtzb3VyY2U6IHJlbmRlcmVyLmRvbUVsZW1lbnR9XG5dKTtcblxuY29uc3QgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuU3BoZXJlR2VvbWV0cnkoIDAuMSwgMzIsIDMyICk7XG5cbmxldCBtYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtjb2xvcjogMHhmZjAwMDB9ICk7XG5cbmNvbnN0IHBvc1hTcGhlcmUgPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdCApO1xucG9zWFNwaGVyZS5wb3NpdGlvbi54ID0gMTtcbmNlbnRlci5hZGQoIHBvc1hTcGhlcmUgKTtcblxubWF0ID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7Y29sb3I6IDB4ZmZhYWFhfSApO1xuXG5jb25zdCBuZWdYU3BoZXJlID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXQgKTtcbm5lZ1hTcGhlcmUucG9zaXRpb24ueCA9IC0xO1xuY2VudGVyLmFkZCggbmVnWFNwaGVyZSApO1xuXG5tYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtjb2xvcjogMHgwMGZmMDB9ICk7XG5cbmNvbnN0IHBvc1lTcGhlcmUgPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdCApO1xucG9zWVNwaGVyZS5wb3NpdGlvbi55ID0gMTtcbmNlbnRlci5hZGQoIHBvc1lTcGhlcmUgKTtcblxubWF0ID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7Y29sb3I6IDB4YWFmZmFhfSApO1xuXG5jb25zdCBuZWdZU3BoZXJlID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXQgKTtcbm5lZ1lTcGhlcmUucG9zaXRpb24ueSA9IC0xO1xuY2VudGVyLmFkZCggbmVnWVNwaGVyZSApO1xuXG5tYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtjb2xvcjogMHgwMDAwZmZ9ICk7XG5cbmNvbnN0IHBvc1pTcGhlcmUgPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdCApO1xucG9zWlNwaGVyZS5wb3NpdGlvbi56ID0gMTtcbmNlbnRlci5hZGQoIHBvc1pTcGhlcmUgKTtcblxubWF0ID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7Y29sb3I6IDB4YWFhYWZmfSApO1xuXG5jb25zdCBuZWdaU3BoZXJlID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXQgKTtcbm5lZ1pTcGhlcmUucG9zaXRpb24ueiA9IC0xO1xuY2VudGVyLmFkZCggbmVnWlNwaGVyZSApO1xuXG4gICAgICAgICAgICBcbnZhciBheGlzSGVscGVyID0gbmV3IFRIUkVFLkF4aXNIZWxwZXIoIDAuMSApO1xuY2VudGVyLmFkZCggYXhpc0hlbHBlciApO1xuXG4vLyB2YXIgdGV4dFNoYXBlcyA9IFRIUkVFLkZvbnRVdGlscy5nZW5lcmF0ZVNoYXBlcyggXCJQb3NaXCIsIG9wdGlvbnMgKTtcbi8vIHZhciB0ZXh0ID0gbmV3IFRIUkVFLlNoYXBlR2VvbWV0cnkoIHRleHRTaGFwZXMgKTtcbi8vIHZhciB0ZXh0TWVzaCA9IG5ldyBUSFJFRS5NZXNoKCB0ZXh0LCBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHsgY29sb3I6IDB4ZmYwMDAwIH0gKSApIDtcbi8vIHNjZW5lLmFkZCh0ZXh0TWVzaCk7XG5cbmFwcC52dWZvcmlhLmluaXQoe1xuZW5jcnlwdGVkTGljZW5zZURhdGE6IGAtLS0tLUJFR0lOIFBHUCBNRVNTQUdFLS0tLS1cbkNvbW1lbnQ6IEdQR1Rvb2xzIC0gaHR0cHM6Ly9ncGd0b29scy5vcmdcblxuaFFJTUExQVVRQ05kbThsaEFRLytLYW02bmFUR3BvNkMyRWtZT1dUS1ZtZUxhNmxENGVwYVJySDNabmhPSG01elxuZHBGbVRlaHhlK0EvSi83LzY4RXZFR0RQZnVWNGNxSFRYTnV2bEF2WTFLNjI1L2k4RWZOcngrblBMMHVtYXA1RVxuV2FZUm5MTkY2TWxDMVB1OGFMWThjOHZkL1pBOWgyWms4UDR0MEMvdU9heUpCWmswQmhLUmxPZ0NKYmpPZDcvWFxuRU1QT0QzWHRGVVA4VDEzS3BxYi9BOGN5SVJUT293bTh5YWo0UGFqVUNBbE9XU1lLWVJjWE01eWcvNXQ3WFRkaVxuM2lVUmdpZEZiV293Ym5xeUZtT0t4QXhxUkJvWFBHWUVEbUs4SWdPZ1ltUjdDNXBWQW1XREs4WmNzVG4yWUMwVFxuSmhZVVNRdlJBMkNzeks5VU1Fb09oMnJxRThSSFpZNE11VlBtMVFOQzFqNHlQMUZTRFp2ZmNKZE9UYlRlQkNjaVxuNkFUQ0FSbWErcm9BM3h0YnpQVldoamM4REd0bFJJSnFqMCtjUmpLOFJNeklNYkJQR2xUWmloZ3Q3VzBzaWZhL1xubTM4ekFsRTRCZTVPbWcra0o3Nmt5WHBoK1NJajBncUJsNXJHMzRPNG40S2dDQm9vaXBqV25BZnp3S0prbkJpWFxuNzRleDk5TFpmL1ZmaWpDakRLa1VwaXlySEhPa1dIRkRlb2xXVFpWbWozRDZIQnFVYUNNR3AzT2JRMEFHQSt0dFxuL0J1Um9oSUhrMXp2U1Q2NkZ6Qm9GeDIrZmN0Wm03YytWSXRBb3lXLytJVnV1bEZDc29RZEU1OWZGODFNYU1hblxuUncxTU5DNmQxdWVtSVpJL3hwK2lseGJwZWxveXB5cldhNlpMemxTY092Ny8vQzVib3daZ2pteENmYlk3U1lIU1xuNlFGeVVsbGNLSVlHb1ZPTVgzMFpyZGFRTVU4MTc3bm5NaWs4SXZyNXprZ3U5RnNLa3dpME1INFhUUDRKcDh6a1xuZVI0ZitielpteGl0VExZb2FKRm5rbXhkenlIVHNJWGdPT3RuZFRoMTgrdVNndkV6K29ld3J2YXdRQ1RYSktYd1xuQndZazd3QXZNbEZ5d01NL0IrSDRrdkJPVGhxRzdqZTJTM1VpdFcxd2FsU3dxK1A4cC92MlV6SXh5K3lHVHpselxuMGVLbWZieDJiMis2cjc2aERWUnQwWGlBdVZLWHE4RXJuZHgyMFZrUlpqM01CT2d1czNYbXZiQ2dPUm4wdzVGL1xuMnNnNmtrTkRyQUk3YVVxODNFRk11RHIzQTZBQmJ0M0M2Y0VQRUIxc0xoc3FobkxUdmtIVHI2SjdCcit3SSsyZlxuZWxUM3gxNW9QVUFqbkRRUjdrQzc3Y21aOFU1by9SMm5ZT2xQekRTeVgzNGNWM3oxNzZocXNzUWEzbC9lYmgrNFxudXVNSGllY3V0L3MyRlZBQ3JpelZ0RUkrWjlJNzNpVVJ3RDlEcmRSdUpLWU1kS29ZRHFvTTQzVmRJWmZOYzNFY1xuajdTS0MvTFNwT0pMOFlRbExvS0x0ZEFqQ1lyWWhEZ3ljQUtLcFR3OUt2NndiU1EzcXhPRVVNcnhLMkkzME5hQVxuOXR1emYxNVdaK1RhdGhHVElMN1ZxTEtTNFVQSzU3enZyZHFuZUI2WGxqNENBQk1JTDNabWdHdUpQcjhXU0pTdVxueE1UWEJvd3FDNGVOdXdVR3RRdHN5Kzd4WWt4T0xzL05WbjJuTk5iNk5sRWFaWDBRVWhxZ1crdDVqM2Q0U1JyeVxua0RZWklicStScVB3YVpoZzBoWHBUNUZ3ejk3eTRaNU55akF1NDRraVlBSzJEdTBWeWkxZTBQTXRXMmphNFpIMFxuPWQrb0dcbi0tLS0tRU5EIFBHUCBNRVNTQUdFLS0tLS1gXG59KS50aGVuKChhcGkpPT57XG4gICAgYXBpLm9iamVjdFRyYWNrZXIuY3JlYXRlRGF0YVNldEZyb21VUkwoJ2RhdGFzZXQvU3RvbmVzQW5kQ2hpcHMueG1sJykudGhlbiggKGlkKT0+e1xuXG4gICAgICAgIGFwaS5vYmplY3RUcmFja2VyLmxvYWREYXRhU2V0KGlkKS50aGVuKCh0cmFja2FibGVzKT0+e1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBzdG9uZXNFbnRpdHkgPSBhcHAuY29udGV4dC5zdWJzY3JpYmVUb0VudGl0eUJ5SWQodHJhY2thYmxlc1snc3RvbmVzJ10uaWQpXG4gICAgICAgICAgICBjb25zdCBzdG9uZXNPYmplY3QgPSBuZXcgVEhSRUUuT2JqZWN0M0Q7XG4gICAgICAgICAgICBzY2VuZS5hZGQoc3RvbmVzT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGJveEdlb21ldHJ5ID0gbmV3IFRIUkVFLkJveEdlb21ldHJ5KDUwLCA1MCwgNTApO1xuICAgICAgICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hOb3JtYWxNYXRlcmlhbCgpXG4gICAgICAgICAgICBtYXRlcmlhbC5zaWRlID0gVEhSRUUuRG91YmxlU2lkZTtcbiAgICAgICAgICAgIGNvbnN0IGJveCA9IG5ldyBUSFJFRS5NZXNoKGJveEdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgICAgICAgICBib3gucG9zaXRpb24ueiA9IDI1O1xuICAgICAgICAgICAgYm94LnBvc2l0aW9uLnkgPSA1MDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGF4aXNIZWxwZXIgPSBuZXcgVEhSRUUuQXhpc0hlbHBlciggMTAgKTtcbiAgICAgICAgICAgIGJveC5hZGQoIGF4aXNIZWxwZXIgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1N1YnNjcmliZXMgdG8gc3RvbmVzIHRyYWNrYWJsZSB3aXRoIGlkICcgKyB0cmFja2FibGVzWydzdG9uZXMnXS5pZCk7XG5cbiAgICAgICAgICAgIGFwcC5jb250ZXh0LnVwZGF0ZUV2ZW50LmFkZEV2ZW50TGlzdGVuZXIoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN0b25lc1Bvc2UgPSBhcHAuY29udGV4dC5nZXRFbnRpdHlQb3NlKHN0b25lc0VudGl0eSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RvbmVzUG9zZS5zdGF0dXMgJiBBcmdvbi5Qb3NlU3RhdHVzLktOT1dOKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b25lc09iamVjdC5wb3NpdGlvbi5jb3B5KDxhbnk+c3RvbmVzUG9zZS5wb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHN0b25lc09iamVjdC5xdWF0ZXJuaW9uLmNvcHkoPGFueT5zdG9uZXNQb3NlLm9yaWVudGF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgc3RvbmVzT2JqZWN0LmFkZChib3gpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b25lc09iamVjdC5yZW1vdmUoYm94KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGFwaS5vYmplY3RUcmFja2VyLmFjdGl2YXRlRGF0YVNldChpZCk7XG4gICAgfSk7XG59KVxuXG4vLyBPbiBmaXJzdCB1cGRhdGUgZXZlbnQsIHNldCB0aGUgc2NlbmUgY2VudGVyIGJhc2VkIG9uIHRoZSBpbml0aWFsIHVzZXIgaGVpZ2h0IFxuYXBwLnVwZGF0ZUV2ZW50Lm9uTmV4dCgoKT0+e1xuICAgIGNvbnN0IHVzZXJTdGFnZVBvc2UgPSBhcHAuY29udGV4dC5nZXRFbnRpdHlQb3NlKGFwcC5jb250ZXh0LnVzZXIsIGFwcC5jb250ZXh0LnN0YWdlKTtcbiAgICBjb25zdCB1c2VySGVpZ2h0T25TdGFnZSA9IHVzZXJTdGFnZVBvc2UucG9zaXRpb24ueTtcbiAgICBjZW50ZXIucG9zaXRpb24ueSA9IHVzZXJIZWlnaHRPblN0YWdlO1xufSlcblxuLy8gT24gZXZlcnkgdXBkYXRlIGV2ZW50LCB1cGRhdGUgdXNlciBhbmQgc3RhZ2UgcG9zZVxuYXBwLnVwZGF0ZUV2ZW50LmFkZEV2ZW50TGlzdGVuZXIoKCkgPT4ge1xuICAgIGNvbnN0IHVzZXJQb3NlID0gYXBwLmNvbnRleHQuZ2V0RW50aXR5UG9zZShhcHAuY29udGV4dC51c2VyKTtcbiAgICB1c2VyLnBvc2l0aW9uLmNvcHkoPGFueT51c2VyUG9zZS5wb3NpdGlvbik7XG4gICAgdXNlci5xdWF0ZXJuaW9uLmNvcHkoPGFueT51c2VyUG9zZS5vcmllbnRhdGlvbik7XG5cbiAgICBjb25zdCBzdGFnZVBvc2UgPSBhcHAuY29udGV4dC5nZXRFbnRpdHlQb3NlKGFwcC5jb250ZXh0LnN0YWdlKTtcbiAgICBzdGFnZS5wb3NpdGlvbi5jb3B5KDxhbnk+c3RhZ2VQb3NlLnBvc2l0aW9uKTtcbiAgICBzdGFnZS5xdWF0ZXJuaW9uLmNvcHkoPGFueT5zdGFnZVBvc2Uub3JpZW50YXRpb24pO1xufSk7XG5cbmFwcC5yZW5kZXJFdmVudC5hZGRFdmVudExpc3RlbmVyKCgpID0+IHtcbiAgICAvLyBjc3MgcmVuZGVyZXIsIGlmIHVzZWQ6XG4gICAgLy8gY29uc3Qgdmlld3BvcnQgPSBhcHAudmlldy52aWV3cG9ydDtcbiAgICAvLyBjc3NSZW5kZXJlci5zZXRTaXplKHZpZXdwb3J0LndpZHRoLCB2aWV3cG9ydC5oZWlnaHQpO1xuXG4gICAgcmVuZGVyZXIuc2V0U2l6ZShhcHAudmlldy5yZW5kZXJXaWR0aCwgYXBwLnZpZXcucmVuZGVySGVpZ2h0LCBmYWxzZSk7XG4gICAgXG4gICAgZm9yIChsZXQgc3VidmlldyBvZiBhcHAudmlldy5zdWJ2aWV3cykge1xuICAgICAgICBjYW1lcmEucG9zaXRpb24uY29weSg8YW55PnN1YnZpZXcucG9zZS5wb3NpdGlvbik7XG4gICAgICAgIGNhbWVyYS5xdWF0ZXJuaW9uLmNvcHkoPGFueT5zdWJ2aWV3LnBvc2Uub3JpZW50YXRpb24pO1xuICAgICAgICBjYW1lcmEucHJvamVjdGlvbk1hdHJpeC5mcm9tQXJyYXkoPGFueT5zdWJ2aWV3LmZydXN0dW0ucHJvamVjdGlvbk1hdHJpeCk7XG5cbiAgICAgICAgbGV0IHt4LHksd2lkdGgsaGVpZ2h0fSA9IHN1YnZpZXcucmVuZGVyVmlld3BvcnQ7XG4gICAgICAgIHJlbmRlcmVyLnNldFZpZXdwb3J0KHgseSx3aWR0aCxoZWlnaHQpO1xuICAgICAgICByZW5kZXJlci5zZXRTY2lzc29yKHgseSx3aWR0aCxoZWlnaHQpO1xuICAgICAgICByZW5kZXJlci5zZXRTY2lzc29yVGVzdCh0cnVlKTtcbiAgICAgICAgcmVuZGVyZXIucmVuZGVyKHNjZW5lLCBjYW1lcmEpO1xuXG4gICAgICAgIC8vIGxldCB7eCx5LHdpZHRoLGhlaWdodH0gPSBzdWJ2aWV3LnZpZXdwb3J0O1xuICAgICAgICAvLyBjc3NSZW5kZXJlci5zZXRWaWV3cG9ydCh4LHksd2lkdGgsaGVpZ2h0LCBzdWJ2aWV3LmluZGV4KVxuICAgIH1cbn0pXG5cbi8vIC8vIGNyZWF0aW5nIDYgZGl2cyB0byBpbmRpY2F0ZSB0aGUgeCB5IHogcG9zaXRpb25pbmdcbi8vIGNvbnN0IGRpdlhwb3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuLy8gY29uc3QgZGl2WG5lZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4vLyBjb25zdCBkaXZZcG9zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcbi8vIGNvbnN0IGRpdlluZWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuLy8gY29uc3QgZGl2WnBvcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4vLyBjb25zdCBkaXZabmVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuLy8gLy8gcHJvZ3JhbWF0aWNhbGx5IGNyZWF0ZSBhIHN0eWxlc2hlZXQgZm9yIG91ciBkaXJlY3Rpb24gZGl2c1xuLy8gLy8gYW5kIGFkZCBpdCB0byB0aGUgZG9jdW1lbnRcbi8vIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuLy8gc3R5bGUudHlwZSA9ICd0ZXh0L2Nzcyc7XG4vLyBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbi8vIGNvbnN0IHNoZWV0ID0gPENTU1N0eWxlU2hlZXQ+c3R5bGUuc2hlZXQ7XG4vLyBzaGVldC5pbnNlcnRSdWxlKGBcbi8vICAgICAuZGlyZWN0aW9uIHtcbi8vICAgICAgICAgb3BhY2l0eTogMC41O1xuLy8gICAgICAgICB3aWR0aDogMTAwcHg7XG4vLyAgICAgICAgIGhlaWdodDogMTAwcHg7XG4vLyAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcbi8vICAgICAgICAgbGluZS1oZWlnaHQ6IDEwMHB4O1xuLy8gICAgICAgICBmb250U2l6ZTogMjBweDtcbi8vICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuLy8gICAgIH1cbi8vIGAsIDApO1xuXG4vLyAvLyBQdXQgY29udGVudCBpbiBlYWNoIG9uZSAgKHNob3VsZCBkbyB0aGlzIGFzIGEgY291cGxlIG9mIGZ1bmN0aW9ucylcbi8vIC8vIGZvciBYXG4vLyBkaXZYcG9zLmNsYXNzTmFtZSA9ICdkaXJlY3Rpb24nXG4vLyBkaXZYcG9zLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCJcbi8vIGRpdlhwb3MuaW5uZXJUZXh0ID0gXCJQb3MgWCA9IEVhc3RcIlxuXG4vLyBkaXZYbmVnLmNsYXNzTmFtZSA9ICdkaXJlY3Rpb24nXG4vLyBkaXZYbmVnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCJcbi8vIGRpdlhuZWcuaW5uZXJUZXh0ID0gXCJOZWcgWCA9IFdlc3RcIlxuXG4vLyAvLyBmb3IgWVxuLy8gZGl2WXBvcy5jbGFzc05hbWUgPSAnZGlyZWN0aW9uJ1xuLy8gZGl2WXBvcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImJsdWVcIlxuLy8gZGl2WXBvcy5pbm5lclRleHQgPSBcIlBvcyBZID0gVXBcIlxuXG4vLyBkaXZZbmVnLmNsYXNzTmFtZSA9ICdkaXJlY3Rpb24nXG4vLyBkaXZZbmVnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiYmx1ZVwiXG4vLyBkaXZZbmVnLmlubmVyVGV4dCA9IFwiTmVnIFkgPSBEb3duXCJcblxuLy8gLy9mb3IgWlxuLy8gZGl2WnBvcy5jbGFzc05hbWUgPSAnZGlyZWN0aW9uJ1xuLy8gZGl2WnBvcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImdyZWVuXCJcbi8vIGRpdlpwb3MuaW5uZXJUZXh0ID0gXCJQb3MgWiA9IFNvdXRoXCJcblxuLy8gZGl2Wm5lZy5jbGFzc05hbWUgPSAnZGlyZWN0aW9uJ1xuLy8gZGl2Wm5lZy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImdyZWVuXCJcbi8vIGRpdlpuZWcuaW5uZXJUZXh0ID0gXCJOZWcgWiA9IE5vcnRoXCJcblxuLy8gLy8gY3JlYXRlIDYgQ1NTM0RPYmplY3RzIGluIHRoZSBzY2VuZSBncmFwaFxuLy8gY29uc3QgY3NzT2JqZWN0WHBvcyA9IG5ldyBUSFJFRS5DU1MzRE9iamVjdChkaXZYcG9zKVxuLy8gY29uc3QgY3NzT2JqZWN0WG5lZyA9IG5ldyBUSFJFRS5DU1MzRE9iamVjdChkaXZYbmVnKVxuLy8gY29uc3QgY3NzT2JqZWN0WXBvcyA9IG5ldyBUSFJFRS5DU1MzRE9iamVjdChkaXZZcG9zKVxuLy8gY29uc3QgY3NzT2JqZWN0WW5lZyA9IG5ldyBUSFJFRS5DU1MzRE9iamVjdChkaXZZbmVnKVxuLy8gY29uc3QgY3NzT2JqZWN0WnBvcyA9IG5ldyBUSFJFRS5DU1MzRE9iamVjdChkaXZacG9zKVxuLy8gY29uc3QgY3NzT2JqZWN0Wm5lZyA9IG5ldyBUSFJFRS5DU1MzRE9iamVjdChkaXZabmVnKVxuXG4vLyAvLyB0aGUgd2lkdGggYW5kIGhlaWdodCBpcyB1c2VkIHRvIGFsaWduIHRoaW5ncy5cbi8vIGNzc09iamVjdFhwb3MucG9zaXRpb24ueCA9IDIwMC4wXG4vLyBjc3NPYmplY3RYcG9zLnJvdGF0aW9uLnkgPSAtIE1hdGguUEkgLyAyXG5cbi8vIGNzc09iamVjdFhuZWcucG9zaXRpb24ueCA9IC0yMDAuMFxuLy8gY3NzT2JqZWN0WG5lZy5yb3RhdGlvbi55ID0gTWF0aC5QSSAvIDJcblxuLy8gLy8gZm9yIFlcbi8vIGNzc09iamVjdFlwb3MucG9zaXRpb24ueSA9IDIwMC4wXG4vLyBjc3NPYmplY3RZcG9zLnJvdGF0aW9uLnggPSBNYXRoLlBJIC8gMlxuXG4vLyBjc3NPYmplY3RZbmVnLnBvc2l0aW9uLnkgPSAtIDIwMC4wXG4vLyBjc3NPYmplY3RZbmVnLnJvdGF0aW9uLnggPSAtIE1hdGguUEkgLyAyXG5cbi8vIC8vIGZvciBaXG4vLyBjc3NPYmplY3RacG9zLnBvc2l0aW9uLnogPSAyMDAuMFxuLy8gY3NzT2JqZWN0WnBvcy5yb3RhdGlvbi55ID0gTWF0aC5QSVxuXG4vLyBjc3NPYmplY3RabmVnLnBvc2l0aW9uLnogPSAtMjAwLjBcbi8vIC8vbm8gcm90YXRpb24gbmVlZCBmb3IgdGhpcyBvbmVcblxuLy8gdXNlckxvY2F0aW9uLmFkZChjc3NPYmplY3RYcG9zKVxuLy8gdXNlckxvY2F0aW9uLmFkZChjc3NPYmplY3RYbmVnKVxuLy8gdXNlckxvY2F0aW9uLmFkZChjc3NPYmplY3RZcG9zKVxuLy8gdXNlckxvY2F0aW9uLmFkZChjc3NPYmplY3RZbmVnKVxuLy8gdXNlckxvY2F0aW9uLmFkZChjc3NPYmplY3RacG9zKVxuLy8gdXNlckxvY2F0aW9uLmFkZChjc3NPYmplY3RabmVnKVxuIl19