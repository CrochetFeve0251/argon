import * as Argon from '../../src/argon';
window['Argon'] = Argon;
var app = window['app'] = Argon.init();
app.context.subscribeGeolocation();
var scene = window['scene'] = new THREE.Scene();
var camera = window['camera'] = new THREE.PerspectiveCamera();
var user = window['user'] = new THREE.Object3D();
var stage = window['stage'] = new THREE.Object3D;
var center = window['center'] = new THREE.Object3D;
scene.add(camera);
scene.add(user);
scene.add(stage);
stage.add(center);
var circle = new THREE.Mesh(new THREE.CircleGeometry(1), new THREE.MeshBasicMaterial({ color: 0x888888 }));
circle.rotation.x = -Math.PI / 2;
circle.material.opacity = 0.1;
circle.material.transparent = true;
stage.add(circle);
var renderer = new THREE.WebGLRenderer({
    alpha: true,
    logarithmicDepthBuffer: true
});
app.view.setLayers([
    { source: renderer.domElement }
]);
var geometry = new THREE.SphereGeometry(0.1, 32, 32);
var mat = new THREE.MeshBasicMaterial({ color: 0xff0000 });
var posXSphere = new THREE.Mesh(geometry, mat);
posXSphere.position.x = 1;
center.add(posXSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xffaaaa });
var negXSphere = new THREE.Mesh(geometry, mat);
negXSphere.position.x = -1;
center.add(negXSphere);
mat = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
var posYSphere = new THREE.Mesh(geometry, mat);
posYSphere.position.y = 1;
center.add(posYSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xaaffaa });
var negYSphere = new THREE.Mesh(geometry, mat);
negYSphere.position.y = -1;
center.add(negYSphere);
mat = new THREE.MeshBasicMaterial({ color: 0x0000ff });
var posZSphere = new THREE.Mesh(geometry, mat);
posZSphere.position.z = 1;
center.add(posZSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xaaaaff });
var negZSphere = new THREE.Mesh(geometry, mat);
negZSphere.position.z = -1;
center.add(negZSphere);
var axisHelper = new THREE.AxisHelper(0.1);
center.add(axisHelper);
// var textShapes = THREE.FontUtils.generateShapes( "PosZ", options );
// var text = new THREE.ShapeGeometry( textShapes );
// var textMesh = new THREE.Mesh( text, new THREE.MeshBasicMaterial( { color: 0xff0000 } ) ) ;
// scene.add(textMesh);
app.vuforia.init({
    encryptedLicenseData: "-----BEGIN PGP MESSAGE-----\nComment: GPGTools - https://gpgtools.org\n\nhQIMA1AUQCNdm8lhAQ/+Kam6naTGpo6C2EkYOWTKVmeLa6lD4epaRrH3ZnhOHm5z\ndpFmTehxe+A/J/7/68EvEGDPfuV4cqHTXNuvlAvY1K625/i8EfNrx+nPL0umap5E\nWaYRnLNF6MlC1Pu8aLY8c8vd/ZA9h2Zk8P4t0C/uOayJBZk0BhKRlOgCJbjOd7/X\nEMPOD3XtFUP8T13Kpqb/A8cyIRTOowm8yaj4PajUCAlOWSYKYRcXM5yg/5t7XTdi\n3iURgidFbWowbnqyFmOKxAxqRBoXPGYEDmK8IgOgYmR7C5pVAmWDK8ZcsTn2YC0T\nJhYUSQvRA2CszK9UMEoOh2rqE8RHZY4MuVPm1QNC1j4yP1FSDZvfcJdOTbTeBCci\n6ATCARma+roA3xtbzPVWhjc8DGtlRIJqj0+cRjK8RMzIMbBPGlTZihgt7W0sifa/\nm38zAlE4Be5Omg+kJ76kyXph+SIj0gqBl5rG34O4n4KgCBooipjWnAfzwKJknBiX\n74ex99LZf/VfijCjDKkUpiyrHHOkWHFDeolWTZVmj3D6HBqUaCMGp3ObQ0AGA+tt\n/BuRohIHk1zvST66FzBoFx2+fctZm7c+VItAoyW/+IVuulFCsoQdE59fF81MaMan\nRw1MNC6d1uemIZI/xp+ilxbpeloypyrWa6ZLzlScOv7//C5bowZgjmxCfbY7SYHS\n6QFyUllcKIYGoVOMX30ZrdaQMU8177nnMik8Ivr5zkgu9FsKkwi0MH4XTP4Jp8zk\neR4f+bzZmxitTLYoaJFnkmxdzyHTsIXgOOtndTh18+uSgvEz+oewrvawQCTXJKXw\nBwYk7wAvMlFywMM/B+H4kvBOThqG7je2S3UitW1walSwq+P8p/v2UzIxy+yGTzlz\n0eKmfbx2b2+6r76hDVRt0XiAuVKXq8Erndx20VkRZj3MBOgus3XmvbCgORn0w5F/\n2sg6kkNDrAI7aUq83EFMuDr3A6ABbt3C6cEPEB1sLhsqhnLTvkHTr6J7Br+wI+2f\nelT3x15oPUAjnDQR7kC77cmZ8U5o/R2nYOlPzDSyX34cV3z176hqssQa3l/ebh+4\nuuMHiecut/s2FVACrizVtEI+Z9I73iURwD9DrdRuJKYMdKoYDqoM43VdIZfNc3Ec\nj7SKC/LSpOJL8YQlLoKLtdAjCYrYhDgycAKKpTw9Kv6wbSQ3qxOEUMrxK2I30NaA\n9tuzf15WZ+TathGTIL7VqLKS4UPK57zvrdqneB6Xlj4CABMIL3ZmgGuJPr8WSJSu\nxMTXBowqC4eNuwUGtQtsy+7xYkxOLs/NVn2nNNb6NlEaZX0QUhqgW+t5j3d4SRry\nkDYZIbq+RqPwaZhg0hXpT5Fwz97y4Z5NyjAu44kiYAK2Du0Vyi1e0PMtW2ja4ZH0\n=d+oG\n-----END PGP MESSAGE-----"
}).then(function (api) {
    api.objectTracker.createDataSetFromURL('dataset/StonesAndChips.xml').then(function (id) {
        api.objectTracker.loadDataSet(id).then(function (trackables) {
            var stonesEntity = app.context.subscribeToEntityById(trackables['stones'].id);
            var stonesObject = new THREE.Object3D;
            scene.add(stonesObject);
            var boxGeometry = new THREE.BoxGeometry(50, 50, 50);
            var material = new THREE.MeshNormalMaterial();
            material.side = THREE.DoubleSide;
            var box = new THREE.Mesh(boxGeometry, material);
            box.position.z = 25;
            box.position.y = 50;
            var axisHelper = new THREE.AxisHelper(10);
            box.add(axisHelper);
            console.log('Subscribes to stones trackable with id ' + trackables['stones'].id);
            app.context.updateEvent.addEventListener(function () {
                var stonesPose = app.context.getEntityPose(stonesEntity);
                if (stonesPose.status & Argon.PoseStatus.KNOWN) {
                    stonesObject.position.copy(stonesPose.position);
                    stonesObject.quaternion.copy(stonesPose.orientation);
                    stonesObject.add(box);
                }
                else {
                    stonesObject.remove(box);
                }
            });
        });
        api.objectTracker.activateDataSet(id);
    });
});
// On first update event, set the scene center based on the initial user height 
app.updateEvent.onNext(function () {
    var userStagePose = app.context.getEntityPose(app.context.user, app.context.stage);
    var userHeightOnStage = userStagePose.position.y;
    center.position.y = userHeightOnStage;
});
// On every update event, update user and stage pose
app.updateEvent.addEventListener(function () {
    var userPose = app.context.getEntityPose(app.context.user);
    user.position.copy(userPose.position);
    user.quaternion.copy(userPose.orientation);
    var stagePose = app.context.getEntityPose(app.context.stage);
    stage.position.copy(stagePose.position);
    stage.quaternion.copy(stagePose.orientation);
});
app.renderEvent.addEventListener(function () {
    // css renderer, if used:
    // const viewport = app.view.viewport;
    // cssRenderer.setSize(viewport.width, viewport.height);
    renderer.setSize(app.view.renderWidth, app.view.renderHeight, false);
    for (var _i = 0, _a = app.view.subviews; _i < _a.length; _i++) {
        var subview = _a[_i];
        camera.position.copy(subview.pose.position);
        camera.quaternion.copy(subview.pose.orientation);
        camera.projectionMatrix.fromArray(subview.frustum.projectionMatrix);
        var _b = subview.renderViewport, x = _b.x, y = _b.y, width = _b.width, height = _b.height;
        renderer.setViewport(x, y, width, height);
        renderer.setScissor(x, y, width, height);
        renderer.setScissorTest(true);
        renderer.render(scene, camera);
        // let {x,y,width,height} = subview.viewport;
        // cssRenderer.setViewport(x,y,width,height, subview.index)
    }
});
// // creating 6 divs to indicate the x y z positioning
// const divXpos = document.createElement('div')
// const divXneg = document.createElement('div')
// const divYpos = document.createElement('div')
// const divYneg = document.createElement('div')
// const divZpos = document.createElement('div')
// const divZneg = document.createElement('div')
// // programatically create a stylesheet for our direction divs
// // and add it to the document
// const style = document.createElement("style");
// style.type = 'text/css';
// document.head.appendChild(style);
// const sheet = <CSSStyleSheet>style.sheet;
// sheet.insertRule(`
//     .direction {
//         opacity: 0.5;
//         width: 100px;
//         height: 100px;
//         border-radius: 50%;
//         line-height: 100px;
//         fontSize: 20px;
//         text-align: center;
//     }
// `, 0);
// // Put content in each one  (should do this as a couple of functions)
// // for X
// divXpos.className = 'direction'
// divXpos.style.backgroundColor = "red"
// divXpos.innerText = "Pos X = East"
// divXneg.className = 'direction'
// divXneg.style.backgroundColor = "red"
// divXneg.innerText = "Neg X = West"
// // for Y
// divYpos.className = 'direction'
// divYpos.style.backgroundColor = "blue"
// divYpos.innerText = "Pos Y = Up"
// divYneg.className = 'direction'
// divYneg.style.backgroundColor = "blue"
// divYneg.innerText = "Neg Y = Down"
// //for Z
// divZpos.className = 'direction'
// divZpos.style.backgroundColor = "green"
// divZpos.innerText = "Pos Z = South"
// divZneg.className = 'direction'
// divZneg.style.backgroundColor = "green"
// divZneg.innerText = "Neg Z = North"
// // create 6 CSS3DObjects in the scene graph
// const cssObjectXpos = new THREE.CSS3DObject(divXpos)
// const cssObjectXneg = new THREE.CSS3DObject(divXneg)
// const cssObjectYpos = new THREE.CSS3DObject(divYpos)
// const cssObjectYneg = new THREE.CSS3DObject(divYneg)
// const cssObjectZpos = new THREE.CSS3DObject(divZpos)
// const cssObjectZneg = new THREE.CSS3DObject(divZneg)
// // the width and height is used to align things.
// cssObjectXpos.position.x = 200.0
// cssObjectXpos.rotation.y = - Math.PI / 2
// cssObjectXneg.position.x = -200.0
// cssObjectXneg.rotation.y = Math.PI / 2
// // for Y
// cssObjectYpos.position.y = 200.0
// cssObjectYpos.rotation.x = Math.PI / 2
// cssObjectYneg.position.y = - 200.0
// cssObjectYneg.rotation.x = - Math.PI / 2
// // for Z
// cssObjectZpos.position.z = 200.0
// cssObjectZpos.rotation.y = Math.PI
// cssObjectZneg.position.z = -200.0
// //no rotation need for this one
// userLocation.add(cssObjectXpos)
// userLocation.add(cssObjectXneg)
// userLocation.add(cssObjectYpos)
// userLocation.add(cssObjectYneg)
// userLocation.add(cssObjectZpos)
// userLocation.add(cssObjectZneg)
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhhbXBsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImV4YW1wbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEtBQUssTUFBTSxpQkFBaUIsQ0FBQTtBQVN4QyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDO0FBRXhCLElBQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7QUFFekMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO0FBRW5DLElBQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNsRCxJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztBQUNoRSxJQUFNLElBQUksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDbkQsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQztBQUNuRCxJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDO0FBRXJELEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDbEIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNoQixLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBRWpCLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFbEIsSUFBTSxNQUFNLEdBQUcsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBRSxFQUFDLEtBQUssRUFBRSxRQUFRLEVBQUMsQ0FBRSxDQUFDLENBQUM7QUFDN0csTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFDLENBQUMsQ0FBQztBQUMvQixNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUM7QUFDOUIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO0FBQ25DLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFbEIsSUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLENBQUMsYUFBYSxDQUFDO0lBQ3JDLEtBQUssRUFBRSxJQUFJO0lBQ1gsc0JBQXNCLEVBQUUsSUFBSTtDQUMvQixDQUFDLENBQUM7QUFFSCxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztJQUNmLEVBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxVQUFVLEVBQUM7Q0FDaEMsQ0FBQyxDQUFDO0FBRUgsSUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLENBQUMsY0FBYyxDQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFFLENBQUM7QUFFekQsSUFBSSxHQUFHLEdBQUcsSUFBSSxLQUFLLENBQUMsaUJBQWlCLENBQUUsRUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFDLENBQUUsQ0FBQztBQUUzRCxJQUFNLFVBQVUsR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUUsUUFBUSxFQUFFLEdBQUcsQ0FBRSxDQUFDO0FBQ25ELFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUMxQixNQUFNLENBQUMsR0FBRyxDQUFFLFVBQVUsQ0FBRSxDQUFDO0FBRXpCLEdBQUcsR0FBRyxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBRSxFQUFDLEtBQUssRUFBRSxRQUFRLEVBQUMsQ0FBRSxDQUFDO0FBRXZELElBQU0sVUFBVSxHQUFHLElBQUksS0FBSyxDQUFDLElBQUksQ0FBRSxRQUFRLEVBQUUsR0FBRyxDQUFFLENBQUM7QUFDbkQsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDM0IsTUFBTSxDQUFDLEdBQUcsQ0FBRSxVQUFVLENBQUUsQ0FBQztBQUV6QixHQUFHLEdBQUcsSUFBSSxLQUFLLENBQUMsaUJBQWlCLENBQUUsRUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFDLENBQUUsQ0FBQztBQUV2RCxJQUFNLFVBQVUsR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUUsUUFBUSxFQUFFLEdBQUcsQ0FBRSxDQUFDO0FBQ25ELFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUMxQixNQUFNLENBQUMsR0FBRyxDQUFFLFVBQVUsQ0FBRSxDQUFDO0FBRXpCLEdBQUcsR0FBRyxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBRSxFQUFDLEtBQUssRUFBRSxRQUFRLEVBQUMsQ0FBRSxDQUFDO0FBRXZELElBQU0sVUFBVSxHQUFHLElBQUksS0FBSyxDQUFDLElBQUksQ0FBRSxRQUFRLEVBQUUsR0FBRyxDQUFFLENBQUM7QUFDbkQsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDM0IsTUFBTSxDQUFDLEdBQUcsQ0FBRSxVQUFVLENBQUUsQ0FBQztBQUV6QixHQUFHLEdBQUcsSUFBSSxLQUFLLENBQUMsaUJBQWlCLENBQUUsRUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFDLENBQUUsQ0FBQztBQUV2RCxJQUFNLFVBQVUsR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUUsUUFBUSxFQUFFLEdBQUcsQ0FBRSxDQUFDO0FBQ25ELFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUMxQixNQUFNLENBQUMsR0FBRyxDQUFFLFVBQVUsQ0FBRSxDQUFDO0FBRXpCLEdBQUcsR0FBRyxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBRSxFQUFD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bidcbi8vIGltcG9ydCAqIGFzIEFyZ29uIGZyb20gJ0BhcmdvbmpzL2FyZ29uJ1xuLy8gaW1wb3J0ICogYXMgQXJnb24gZnJvbSAnLi4vZGlzdC9zcmMvYXJnb24nXG5cbmltcG9ydCBfX1RIUkVFIGZyb20gJ3RocmVlJztcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgY29uc3QgVEhSRUU6IHR5cGVvZiBfX1RIUkVFO1xufVxuXG53aW5kb3dbJ0FyZ29uJ10gPSBBcmdvbjtcblxuY29uc3QgYXBwID0gd2luZG93WydhcHAnXSA9IEFyZ29uLmluaXQoKTtcblxuYXBwLmNvbnRleHQuc3Vic2NyaWJlR2VvbG9jYXRpb24oKTtcblxuY29uc3Qgc2NlbmUgPSB3aW5kb3dbJ3NjZW5lJ10gPSBuZXcgVEhSRUUuU2NlbmUoKTtcbmNvbnN0IGNhbWVyYSA9IHdpbmRvd1snY2FtZXJhJ10gPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoKTtcbmNvbnN0IHVzZXIgPSB3aW5kb3dbJ3VzZXInXSA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuY29uc3Qgc3RhZ2UgPSB3aW5kb3dbJ3N0YWdlJ10gPSBuZXcgVEhSRUUuT2JqZWN0M0Q7XG5jb25zdCBjZW50ZXIgPSB3aW5kb3dbJ2NlbnRlciddID0gbmV3IFRIUkVFLk9iamVjdDNEO1xuXG5zY2VuZS5hZGQoY2FtZXJhKTtcbnNjZW5lLmFkZCh1c2VyKTtcbnNjZW5lLmFkZChzdGFnZSk7XG5cbnN0YWdlLmFkZChjZW50ZXIpOyBcblxuY29uc3QgY2lyY2xlID0gbmV3IFRIUkVFLk1lc2gobmV3IFRIUkVFLkNpcmNsZUdlb21ldHJ5KDEpLCBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtjb2xvcjogMHg4ODg4ODh9ICkpO1xuY2lyY2xlLnJvdGF0aW9uLnggPSAtTWF0aC5QSS8yO1xuY2lyY2xlLm1hdGVyaWFsLm9wYWNpdHkgPSAwLjE7XG5jaXJjbGUubWF0ZXJpYWwudHJhbnNwYXJlbnQgPSB0cnVlO1xuc3RhZ2UuYWRkKGNpcmNsZSk7XG5cbmNvbnN0IHJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoeyBcbiAgICBhbHBoYTogdHJ1ZSwgXG4gICAgbG9nYXJpdGhtaWNEZXB0aEJ1ZmZlcjogdHJ1ZVxufSk7XG5cbmFwcC52aWV3LnNldExheWVycyhbXG4gICAge3NvdXJjZTogcmVuZGVyZXIuZG9tRWxlbWVudH1cbl0pO1xuXG5jb25zdCBnZW9tZXRyeSA9IG5ldyBUSFJFRS5TcGhlcmVHZW9tZXRyeSggMC4xLCAzMiwgMzIgKTtcblxubGV0IG1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCgge2NvbG9yOiAweGZmMDAwMH0gKTtcblxuY29uc3QgcG9zWFNwaGVyZSA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ICk7XG5wb3NYU3BoZXJlLnBvc2l0aW9uLnggPSAxO1xuY2VudGVyLmFkZCggcG9zWFNwaGVyZSApO1xuXG5tYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtjb2xvcjogMHhmZmFhYWF9ICk7XG5cbmNvbnN0IG5lZ1hTcGhlcmUgPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdCApO1xubmVnWFNwaGVyZS5wb3NpdGlvbi54ID0gLTE7XG5jZW50ZXIuYWRkKCBuZWdYU3BoZXJlICk7XG5cbm1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCgge2NvbG9yOiAweDAwZmYwMH0gKTtcblxuY29uc3QgcG9zWVNwaGVyZSA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ICk7XG5wb3NZU3BoZXJlLnBvc2l0aW9uLnkgPSAxO1xuY2VudGVyLmFkZCggcG9zWVNwaGVyZSApO1xuXG5tYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtjb2xvcjogMHhhYWZmYWF9ICk7XG5cbmNvbnN0IG5lZ1lTcGhlcmUgPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdCApO1xubmVnWVNwaGVyZS5wb3NpdGlvbi55ID0gLTE7XG5jZW50ZXIuYWRkKCBuZWdZU3BoZXJlICk7XG5cbm1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCgge2NvbG9yOiAweDAwMDBmZn0gKTtcblxuY29uc3QgcG9zWlNwaGVyZSA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ICk7XG5wb3NaU3BoZXJlLnBvc2l0aW9uLnogPSAxO1xuY2VudGVyLmFkZCggcG9zWlNwaGVyZSApO1xuXG5tYXQgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHtjb2xvcjogMHhhYWFhZmZ9ICk7XG5cbmNvbnN0IG5lZ1pTcGhlcmUgPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdCApO1xubmVnWlNwaGVyZS5wb3NpdGlvbi56ID0gLTE7XG5jZW50ZXIuYWRkKCBuZWdaU3BoZXJlICk7XG5cbiAgICAgICAgICAgIFxudmFyIGF4aXNIZWxwZXIgPSBuZXcgVEhSRUUuQXhpc0hlbHBlciggMC4xICk7XG5jZW50ZXIuYWRkKCBheGlzSGVscGVyICk7XG5cbi8vIHZhciB0ZXh0U2hhcGVzID0gVEhSRUUuRm9udFV0aWxzLmdlbmVyYXRlU2hhcGVzKCBcIlBvc1pcIiwgb3B0aW9ucyApO1xuLy8gdmFyIHRleHQgPSBuZXcgVEhSRUUuU2hhcGVHZW9tZXRyeSggdGV4dFNoYXBlcyApO1xuLy8gdmFyIHRleHRNZXNoID0gbmV3IFRIUkVFLk1lc2goIHRleHQsIG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCggeyBjb2xvcjogMHhmZjAwMDAgfSApICkgO1xuLy8gc2NlbmUuYWRkKHRleHRNZXNoKTtcblxuYXBwLnZ1Zm9yaWEuaW5pdCh7XG5lbmNyeXB0ZWRMaWNlbnNlRGF0YTogYC0tLS0tQkVHSU4gUEdQIE1FU1NBR0UtLS0tLVxuQ29tbWVudDogR1BHVG9vbHMgLSBodHRwczovL2dwZ3Rvb2xzLm9yZ1xuXG5oUUlNQTFBVVFDTmRtOGxoQVEvK0thbTZuYVRHcG82QzJFa1lPV1RLVm1lTGE2bEQ0ZXBhUnJIM1puaE9IbTV6XG5kcEZtVGVoeGUrQS9KLzcvNjhFdkVHRFBmdVY0Y3FIVFhOdXZsQXZZMUs2MjUvaThFZk5yeCtuUEwwdW1hcDVFXG5XYVlSbkxORjZNbEMxUHU4YUxZOGM4dmQvWkE5aDJaazhQNHQwQy91T2F5SkJaazBCaEtSbE9nQ0piak9kNy9YXG5FTVBPRDNYdEZVUDhUMTNLcHFiL0E4Y3lJUlRPb3dtOHlhajRQYWpVQ0FsT1dTWUtZUmNYTTV5Zy81dDdYVGRpXG4zaVVSZ2lkRmJXb3dibnF5Rm1PS3hBeHFSQm9YUEdZRURtSzhJZ09nWW1SN0M1cFZBbVdESzhaY3NUbjJZQzBUXG5KaFlVU1F2UkEyQ3N6SzlVTUVvT2gycnFFOFJIWlk0TXVWUG0xUU5DMWo0eVAxRlNEWnZmY0pkT1RiVGVCQ2NpXG42QVRDQVJtYStyb0EzeHRielBWV2hqYzhER3RsUklKcWowK2NSaks4Uk16SU1iQlBHbFRaaWhndDdXMHNpZmEvXG5tMzh6QWxFNEJlNU9tZytrSjc2a3lYcGgrU0lqMGdxQmw1ckczNE80bjRLZ0NCb29pcGpXbkFmendLSmtuQmlYXG43NGV4OTlMWmYvVmZpakNqREtrVXBpeXJISE9rV0hGRGVvbFdUWlZtajNENkhCcVVhQ01HcDNPYlEwQUdBK3R0XG4vQnVSb2hJSGsxenZTVDY2RnpCb0Z4MitmY3RabTdjK1ZJdEFveVcvK0lWdXVsRkNzb1FkRTU5ZkY4MU1hTWFuXG5SdzFNTkM2ZDF1ZW1JWkkveHAraWx4YnBlbG95cHlyV2E2Wkx6bFNjT3Y3Ly9DNWJvd1pnam14Q2ZiWTdTWUhTXG42UUZ5VWxsY0tJWUdvVk9NWDMwWnJkYVFNVTgxNzdubk1pazhJdnI1emtndTlGc0trd2kwTUg0WFRQNEpwOHprXG5lUjRmK2J6Wm14aXRUTFlvYUpGbmtteGR6eUhUc0lYZ09PdG5kVGgxOCt1U2d2RXorb2V3cnZhd1FDVFhKS1h3XG5Cd1lrN3dBdk1sRnl3TU0vQitINGt2Qk9UaHFHN2plMlMzVWl0VzF3YWxTd3ErUDhwL3YyVXpJeHkreUdUemx6XG4wZUttZmJ4MmIyKzZyNzZoRFZSdDBYaUF1VktYcThFcm5keDIwVmtSWmozTUJPZ3VzM1htdmJDZ09SbjB3NUYvXG4yc2c2a2tORHJBSTdhVXE4M0VGTXVEcjNBNkFCYnQzQzZjRVBFQjFzTGhzcWhuTFR2a0hUcjZKN0JyK3dJKzJmXG5lbFQzeDE1b1BVQWpuRFFSN2tDNzdjbVo4VTVvL1IybllPbFB6RFN5WDM0Y1YzejE3Nmhxc3NRYTNsL2ViaCs0XG51dU1IaWVjdXQvczJGVkFDcml6VnRFSStaOUk3M2lVUndEOURyZFJ1SktZTWRLb1lEcW9NNDNWZElaZk5jM0VjXG5qN1NLQy9MU3BPSkw4WVFsTG9LTHRkQWpDWXJZaERneWNBS0twVHc5S3Y2d2JTUTNxeE9FVU1yeEsySTMwTmFBXG45dHV6ZjE1V1orVGF0aEdUSUw3VnFMS1M0VVBLNTd6dnJkcW5lQjZYbGo0Q0FCTUlMM1ptZ0d1SlByOFdTSlN1XG54TVRYQm93cUM0ZU51d1VHdFF0c3krN3hZa3hPTHMvTlZuMm5OTmI2TmxFYVpYMFFVaHFnVyt0NWozZDRTUnJ5XG5rRFlaSWJxK1JxUHdhWmhnMGhYcFQ1Rnd6OTd5NFo1TnlqQXU0NGtpWUFLMkR1MFZ5aTFlMFBNdFcyamE0WkgwXG49ZCtvR1xuLS0tLS1FTkQgUEdQIE1FU1NBR0UtLS0tLWBcbn0pLnRoZW4oKGFwaSk9PntcbiAgICBhcGkub2JqZWN0VHJhY2tlci5jcmVhdGVEYXRhU2V0RnJvbVVSTCgnZGF0YXNldC9TdG9uZXNBbmRDaGlwcy54bWwnKS50aGVuKCAoaWQpPT57XG5cbiAgICAgICAgYXBpLm9iamVjdFRyYWNrZXIubG9hZERhdGFTZXQoaWQpLnRoZW4oKHRyYWNrYWJsZXMpPT57XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHN0b25lc0VudGl0eSA9IGFwcC5jb250ZXh0LnN1YnNjcmliZVRvRW50aXR5QnlJZCh0cmFja2FibGVzWydzdG9uZXMnXS5pZClcbiAgICAgICAgICAgIGNvbnN0IHN0b25lc09iamVjdCA9IG5ldyBUSFJFRS5PYmplY3QzRDtcbiAgICAgICAgICAgIHNjZW5lLmFkZChzdG9uZXNPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgYm94R2VvbWV0cnkgPSBuZXcgVEhSRUUuQm94R2VvbWV0cnkoNTAsIDUwLCA1MCk7XG4gICAgICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaE5vcm1hbE1hdGVyaWFsKClcbiAgICAgICAgICAgIG1hdGVyaWFsLnNpZGUgPSBUSFJFRS5Eb3VibGVTaWRlO1xuICAgICAgICAgICAgY29uc3QgYm94ID0gbmV3IFRIUkVFLk1lc2goYm94R2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICAgICAgICAgIGJveC5wb3NpdGlvbi56ID0gMjU7XG4gICAgICAgICAgICBib3gucG9zaXRpb24ueSA9IDUwO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgYXhpc0hlbHBlciA9IG5ldyBUSFJFRS5BeGlzSGVscGVyKCAxMCApO1xuICAgICAgICAgICAgYm94LmFkZCggYXhpc0hlbHBlciApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU3Vic2NyaWJlcyB0byBzdG9uZXMgdHJhY2thYmxlIHdpdGggaWQgJyArIHRyYWNrYWJsZXNbJ3N0b25lcyddLmlkKTtcblxuICAgICAgICAgICAgYXBwLmNvbnRleHQudXBkYXRlRXZlbnQuYWRkRXZlbnRMaXN0ZW5lcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3RvbmVzUG9zZSA9IGFwcC5jb250ZXh0LmdldEVudGl0eVBvc2Uoc3RvbmVzRW50aXR5KTtcblxuICAgICAgICAgICAgICAgIGlmIChzdG9uZXNQb3NlLnN0YXR1cyAmIEFyZ29uLlBvc2VTdGF0dXMuS05PV04pIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvbmVzT2JqZWN0LnBvc2l0aW9uLmNvcHkoPGFueT5zdG9uZXNQb3NlLnBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgc3RvbmVzT2JqZWN0LnF1YXRlcm5pb24uY29weSg8YW55PnN0b25lc1Bvc2Uub3JpZW50YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBzdG9uZXNPYmplY3QuYWRkKGJveCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3RvbmVzT2JqZWN0LnJlbW92ZShib3gpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgYXBpLm9iamVjdFRyYWNrZXIuYWN0aXZhdGVEYXRhU2V0KGlkKTtcbiAgICB9KTtcbn0pXG5cbi8vIE9uIGZpcnN0IHVwZGF0ZSBldmVudCwgc2V0IHRoZSBzY2VuZSBjZW50ZXIgYmFzZWQgb24gdGhlIGluaXRpYWwgdXNlciBoZWlnaHQgXG5hcHAudXBkYXRlRXZlbnQub25OZXh0KCgpPT57XG4gICAgY29uc3QgdXNlclN0YWdlUG9zZSA9IGFwcC5jb250ZXh0LmdldEVudGl0eVBvc2UoYXBwLmNvbnRleHQudXNlciwgYXBwLmNvbnRleHQuc3RhZ2UpO1xuICAgIGNvbnN0IHVzZXJIZWlnaHRPblN0YWdlID0gdXNlclN0YWdlUG9zZS5wb3NpdGlvbi55O1xuICAgIGNlbnRlci5wb3NpdGlvbi55ID0gdXNlckhlaWdodE9uU3RhZ2U7XG59KVxuXG4vLyBPbiBldmVyeSB1cGRhdGUgZXZlbnQsIHVwZGF0ZSB1c2VyIGFuZCBzdGFnZSBwb3NlXG5hcHAudXBkYXRlRXZlbnQuYWRkRXZlbnRMaXN0ZW5lcigoKSA9PiB7XG4gICAgY29uc3QgdXNlclBvc2UgPSBhcHAuY29udGV4dC5nZXRFbnRpdHlQb3NlKGFwcC5jb250ZXh0LnVzZXIpO1xuICAgIHVzZXIucG9zaXRpb24uY29weSg8YW55PnVzZXJQb3NlLnBvc2l0aW9uKTtcbiAgICB1c2VyLnF1YXRlcm5pb24uY29weSg8YW55PnVzZXJQb3NlLm9yaWVudGF0aW9uKTtcblxuICAgIGNvbnN0IHN0YWdlUG9zZSA9IGFwcC5jb250ZXh0LmdldEVudGl0eVBvc2UoYXBwLmNvbnRleHQuc3RhZ2UpO1xuICAgIHN0YWdlLnBvc2l0aW9uLmNvcHkoPGFueT5zdGFnZVBvc2UucG9zaXRpb24pO1xuICAgIHN0YWdlLnF1YXRlcm5pb24uY29weSg8YW55PnN0YWdlUG9zZS5vcmllbnRhdGlvbik7XG59KTtcblxuYXBwLnJlbmRlckV2ZW50LmFkZEV2ZW50TGlzdGVuZXIoKCkgPT4ge1xuICAgIC8vIGNzcyByZW5kZXJlciwgaWYgdXNlZDpcbiAgICAvLyBjb25zdCB2aWV3cG9ydCA9IGFwcC52aWV3LnZpZXdwb3J0O1xuICAgIC8vIGNzc1JlbmRlcmVyLnNldFNpemUodmlld3BvcnQud2lkdGgsIHZpZXdwb3J0LmhlaWdodCk7XG5cbiAgICByZW5kZXJlci5zZXRTaXplKGFwcC52aWV3LnJlbmRlcldpZHRoLCBhcHAudmlldy5yZW5kZXJIZWlnaHQsIGZhbHNlKTtcbiAgICBcbiAgICBmb3IgKGxldCBzdWJ2aWV3IG9mIGFwcC52aWV3LnN1YnZpZXdzKSB7XG4gICAgICAgIGNhbWVyYS5wb3NpdGlvbi5jb3B5KDxhbnk+c3Vidmlldy5wb3NlLnBvc2l0aW9uKTtcbiAgICAgICAgY2FtZXJhLnF1YXRlcm5pb24uY29weSg8YW55PnN1YnZpZXcucG9zZS5vcmllbnRhdGlvbik7XG4gICAgICAgIGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4LmZyb21BcnJheSg8YW55PnN1YnZpZXcuZnJ1c3R1bS5wcm9qZWN0aW9uTWF0cml4KTtcblxuICAgICAgICBsZXQge3gseSx3aWR0aCxoZWlnaHR9ID0gc3Vidmlldy5yZW5kZXJWaWV3cG9ydDtcbiAgICAgICAgcmVuZGVyZXIuc2V0Vmlld3BvcnQoeCx5LHdpZHRoLGhlaWdodCk7XG4gICAgICAgIHJlbmRlcmVyLnNldFNjaXNzb3IoeCx5LHdpZHRoLGhlaWdodCk7XG4gICAgICAgIHJlbmRlcmVyLnNldFNjaXNzb3JUZXN0KHRydWUpO1xuICAgICAgICByZW5kZXJlci5yZW5kZXIoc2NlbmUsIGNhbWVyYSk7XG5cbiAgICAgICAgLy8gbGV0IHt4LHksd2lkdGgsaGVpZ2h0fSA9IHN1YnZpZXcudmlld3BvcnQ7XG4gICAgICAgIC8vIGNzc1JlbmRlcmVyLnNldFZpZXdwb3J0KHgseSx3aWR0aCxoZWlnaHQsIHN1YnZpZXcuaW5kZXgpXG4gICAgfVxufSlcblxuLy8gLy8gY3JlYXRpbmcgNiBkaXZzIHRvIGluZGljYXRlIHRoZSB4IHkgeiBwb3NpdGlvbmluZ1xuLy8gY29uc3QgZGl2WHBvcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4vLyBjb25zdCBkaXZYbmVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcbi8vIGNvbnN0IGRpdllwb3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuLy8gY29uc3QgZGl2WW5lZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4vLyBjb25zdCBkaXZacG9zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcbi8vIGNvbnN0IGRpdlpuZWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4vLyAvLyBwcm9ncmFtYXRpY2FsbHkgY3JlYXRlIGEgc3R5bGVzaGVldCBmb3Igb3VyIGRpcmVjdGlvbiBkaXZzXG4vLyAvLyBhbmQgYWRkIGl0IHRvIHRoZSBkb2N1bWVudFxuLy8gY29uc3Qgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4vLyBzdHlsZS50eXBlID0gJ3RleHQvY3NzJztcbi8vIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuLy8gY29uc3Qgc2hlZXQgPSA8Q1NTU3R5bGVTaGVldD5zdHlsZS5zaGVldDtcbi8vIHNoZWV0Lmluc2VydFJ1bGUoYFxuLy8gICAgIC5kaXJlY3Rpb24ge1xuLy8gICAgICAgICBvcGFjaXR5OiAwLjU7XG4vLyAgICAgICAgIHdpZHRoOiAxMDBweDtcbi8vICAgICAgICAgaGVpZ2h0OiAxMDBweDtcbi8vICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xuLy8gICAgICAgICBsaW5lLWhlaWdodDogMTAwcHg7XG4vLyAgICAgICAgIGZvbnRTaXplOiAyMHB4O1xuLy8gICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4vLyAgICAgfVxuLy8gYCwgMCk7XG5cbi8vIC8vIFB1dCBjb250ZW50IGluIGVhY2ggb25lICAoc2hvdWxkIGRvIHRoaXMgYXMgYSBjb3VwbGUgb2YgZnVuY3Rpb25zKVxuLy8gLy8gZm9yIFhcbi8vIGRpdlhwb3MuY2xhc3NOYW1lID0gJ2RpcmVjdGlvbidcbi8vIGRpdlhwb3Muc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIlxuLy8gZGl2WHBvcy5pbm5lclRleHQgPSBcIlBvcyBYID0gRWFzdFwiXG5cbi8vIGRpdlhuZWcuY2xhc3NOYW1lID0gJ2RpcmVjdGlvbidcbi8vIGRpdlhuZWcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZWRcIlxuLy8gZGl2WG5lZy5pbm5lclRleHQgPSBcIk5lZyBYID0gV2VzdFwiXG5cbi8vIC8vIGZvciBZXG4vLyBkaXZZcG9zLmNsYXNzTmFtZSA9ICdkaXJlY3Rpb24nXG4vLyBkaXZZcG9zLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiYmx1ZVwiXG4vLyBkaXZZcG9zLmlubmVyVGV4dCA9IFwiUG9zIFkgPSBVcFwiXG5cbi8vIGRpdlluZWcuY2xhc3NOYW1lID0gJ2RpcmVjdGlvbidcbi8vIGRpdlluZWcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJibHVlXCJcbi8vIGRpdlluZWcuaW5uZXJUZXh0ID0gXCJOZWcgWSA9IERvd25cIlxuXG4vLyAvL2ZvciBaXG4vLyBkaXZacG9zLmNsYXNzTmFtZSA9ICdkaXJlY3Rpb24nXG4vLyBkaXZacG9zLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JlZW5cIlxuLy8gZGl2WnBvcy5pbm5lclRleHQgPSBcIlBvcyBaID0gU291dGhcIlxuXG4vLyBkaXZabmVnLmNsYXNzTmFtZSA9ICdkaXJlY3Rpb24nXG4vLyBkaXZabmVnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JlZW5cIlxuLy8gZGl2Wm5lZy5pbm5lclRleHQgPSBcIk5lZyBaID0gTm9ydGhcIlxuXG4vLyAvLyBjcmVhdGUgNiBDU1MzRE9iamVjdHMgaW4gdGhlIHNjZW5lIGdyYXBoXG4vLyBjb25zdCBjc3NPYmplY3RYcG9zID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KGRpdlhwb3MpXG4vLyBjb25zdCBjc3NPYmplY3RYbmVnID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KGRpdlhuZWcpXG4vLyBjb25zdCBjc3NPYmplY3RZcG9zID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KGRpdllwb3MpXG4vLyBjb25zdCBjc3NPYmplY3RZbmVnID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KGRpdlluZWcpXG4vLyBjb25zdCBjc3NPYmplY3RacG9zID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KGRpdlpwb3MpXG4vLyBjb25zdCBjc3NPYmplY3RabmVnID0gbmV3IFRIUkVFLkNTUzNET2JqZWN0KGRpdlpuZWcpXG5cbi8vIC8vIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IGlzIHVzZWQgdG8gYWxpZ24gdGhpbmdzLlxuLy8gY3NzT2JqZWN0WHBvcy5wb3NpdGlvbi54ID0gMjAwLjBcbi8vIGNzc09iamVjdFhwb3Mucm90YXRpb24ueSA9IC0gTWF0aC5QSSAvIDJcblxuLy8gY3NzT2JqZWN0WG5lZy5wb3NpdGlvbi54ID0gLTIwMC4wXG4vLyBjc3NPYmplY3RYbmVnLnJvdGF0aW9uLnkgPSBNYXRoLlBJIC8gMlxuXG4vLyAvLyBmb3IgWVxuLy8gY3NzT2JqZWN0WXBvcy5wb3NpdGlvbi55ID0gMjAwLjBcbi8vIGNzc09iamVjdFlwb3Mucm90YXRpb24ueCA9IE1hdGguUEkgLyAyXG5cbi8vIGNzc09iamVjdFluZWcucG9zaXRpb24ueSA9IC0gMjAwLjBcbi8vIGNzc09iamVjdFluZWcucm90YXRpb24ueCA9IC0gTWF0aC5QSSAvIDJcblxuLy8gLy8gZm9yIFpcbi8vIGNzc09iamVjdFpwb3MucG9zaXRpb24ueiA9IDIwMC4wXG4vLyBjc3NPYmplY3RacG9zLnJvdGF0aW9uLnkgPSBNYXRoLlBJXG5cbi8vIGNzc09iamVjdFpuZWcucG9zaXRpb24ueiA9IC0yMDAuMFxuLy8gLy9ubyByb3RhdGlvbiBuZWVkIGZvciB0aGlzIG9uZVxuXG4vLyB1c2VyTG9jYXRpb24uYWRkKGNzc09iamVjdFhwb3MpXG4vLyB1c2VyTG9jYXRpb24uYWRkKGNzc09iamVjdFhuZWcpXG4vLyB1c2VyTG9jYXRpb24uYWRkKGNzc09iamVjdFlwb3MpXG4vLyB1c2VyTG9jYXRpb24uYWRkKGNzc09iamVjdFluZWcpXG4vLyB1c2VyTG9jYXRpb24uYWRkKGNzc09iamVjdFpwb3MpXG4vLyB1c2VyTG9jYXRpb24uYWRkKGNzc09iamVjdFpuZWcpXG4iXX0=