import * as Argon from '../../src/argon';
window['Argon'] = Argon;
var app = window['app'] = Argon.init();
app.context.subscribeGeolocation();
var scene = window['scene'] = new THREE.Scene();
var camera = window['camera'] = new THREE.PerspectiveCamera();
var user = window['user'] = new THREE.Object3D();
var stage = window['stage'] = new THREE.Object3D;
var center = window['center'] = new THREE.Object3D;
scene.add(camera);
scene.add(user);
scene.add(stage);
stage.add(center);
var renderer = new THREE.WebGLRenderer({
    alpha: true,
    logarithmicDepthBuffer: true
});
app.view.setLayers([
    { source: renderer.domElement }
]);
var geometry = new THREE.SphereGeometry(0.1, 32, 32);
var mat = new THREE.MeshBasicMaterial({ color: 0xff0000 });
var posXSphere = new THREE.Mesh(geometry, mat);
posXSphere.position.x = 1;
center.add(posXSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xffaaaa });
var negXSphere = new THREE.Mesh(geometry, mat);
negXSphere.position.x = -1;
center.add(negXSphere);
mat = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
var posYSphere = new THREE.Mesh(geometry, mat);
posYSphere.position.y = 1;
center.add(posYSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xaaffaa });
var negYSphere = new THREE.Mesh(geometry, mat);
negYSphere.position.y = -1;
center.add(negYSphere);
mat = new THREE.MeshBasicMaterial({ color: 0x0000ff });
var posZSphere = new THREE.Mesh(geometry, mat);
posZSphere.position.z = 1;
center.add(posZSphere);
mat = new THREE.MeshBasicMaterial({ color: 0xaaaaff });
var negZSphere = new THREE.Mesh(geometry, mat);
negZSphere.position.z = -1;
center.add(negZSphere);
var axisHelper = new THREE.AxisHelper(0.1);
center.add(axisHelper);
// var textShapes = THREE.FontUtils.generateShapes( "PosZ", options );
// var text = new THREE.ShapeGeometry( textShapes );
// var textMesh = new THREE.Mesh( text, new THREE.MeshBasicMaterial( { color: 0xff0000 } ) ) ;
// scene.add(textMesh);
app.vuforia.init({
    encryptedLicenseData: "-----BEGIN PGP MESSAGE-----\nComment: GPGTools - https://gpgtools.org\n\nhQIMA1AUQCNdm8lhAQ/+Kam6naTGpo6C2EkYOWTKVmeLa6lD4epaRrH3ZnhOHm5z\ndpFmTehxe+A/J/7/68EvEGDPfuV4cqHTXNuvlAvY1K625/i8EfNrx+nPL0umap5E\nWaYRnLNF6MlC1Pu8aLY8c8vd/ZA9h2Zk8P4t0C/uOayJBZk0BhKRlOgCJbjOd7/X\nEMPOD3XtFUP8T13Kpqb/A8cyIRTOowm8yaj4PajUCAlOWSYKYRcXM5yg/5t7XTdi\n3iURgidFbWowbnqyFmOKxAxqRBoXPGYEDmK8IgOgYmR7C5pVAmWDK8ZcsTn2YC0T\nJhYUSQvRA2CszK9UMEoOh2rqE8RHZY4MuVPm1QNC1j4yP1FSDZvfcJdOTbTeBCci\n6ATCARma+roA3xtbzPVWhjc8DGtlRIJqj0+cRjK8RMzIMbBPGlTZihgt7W0sifa/\nm38zAlE4Be5Omg+kJ76kyXph+SIj0gqBl5rG34O4n4KgCBooipjWnAfzwKJknBiX\n74ex99LZf/VfijCjDKkUpiyrHHOkWHFDeolWTZVmj3D6HBqUaCMGp3ObQ0AGA+tt\n/BuRohIHk1zvST66FzBoFx2+fctZm7c+VItAoyW/+IVuulFCsoQdE59fF81MaMan\nRw1MNC6d1uemIZI/xp+ilxbpeloypyrWa6ZLzlScOv7//C5bowZgjmxCfbY7SYHS\n6QFyUllcKIYGoVOMX30ZrdaQMU8177nnMik8Ivr5zkgu9FsKkwi0MH4XTP4Jp8zk\neR4f+bzZmxitTLYoaJFnkmxdzyHTsIXgOOtndTh18+uSgvEz+oewrvawQCTXJKXw\nBwYk7wAvMlFywMM/B+H4kvBOThqG7je2S3UitW1walSwq+P8p/v2UzIxy+yGTzlz\n0eKmfbx2b2+6r76hDVRt0XiAuVKXq8Erndx20VkRZj3MBOgus3XmvbCgORn0w5F/\n2sg6kkNDrAI7aUq83EFMuDr3A6ABbt3C6cEPEB1sLhsqhnLTvkHTr6J7Br+wI+2f\nelT3x15oPUAjnDQR7kC77cmZ8U5o/R2nYOlPzDSyX34cV3z176hqssQa3l/ebh+4\nuuMHiecut/s2FVACrizVtEI+Z9I73iURwD9DrdRuJKYMdKoYDqoM43VdIZfNc3Ec\nj7SKC/LSpOJL8YQlLoKLtdAjCYrYhDgycAKKpTw9Kv6wbSQ3qxOEUMrxK2I30NaA\n9tuzf15WZ+TathGTIL7VqLKS4UPK57zvrdqneB6Xlj4CABMIL3ZmgGuJPr8WSJSu\nxMTXBowqC4eNuwUGtQtsy+7xYkxOLs/NVn2nNNb6NlEaZX0QUhqgW+t5j3d4SRry\nkDYZIbq+RqPwaZhg0hXpT5Fwz97y4Z5NyjAu44kiYAK2Du0Vyi1e0PMtW2ja4ZH0\n=d+oG\n-----END PGP MESSAGE-----"
}).then(function (api) {
    api.objectTracker.createDataSetFromURL('dataset/StonesAndChips.xml').then(function (id) {
        api.objectTracker.loadDataSet(id).then(function (trackables) {
            var stonesEntity = app.context.subscribeToEntityById(trackables['stones'].id);
            var stonesObject = new THREE.Object3D;
            scene.add(stonesObject);
            var boxGeometry = new THREE.BoxGeometry(50, 50, 50);
            var material = new THREE.MeshNormalMaterial();
            material.side = THREE.DoubleSide;
            var box = new THREE.Mesh(boxGeometry, material);
            box.position.z = 25;
            box.position.y = 50;
            var axisHelper = new THREE.AxisHelper(10);
            box.add(axisHelper);
            console.log('Subscribes to stones trackable with id ' + trackables['stones'].id);
            app.context.updateEvent.addEventListener(function () {
                var stonesPose = app.context.getEntityPose(stonesEntity);
                if (stonesPose.status & Argon.PoseStatus.KNOWN) {
                    stonesObject.position.copy(stonesPose.position);
                    stonesObject.quaternion.copy(stonesPose.orientation);
                    stonesObject.add(box);
                }
                else {
                    stonesObject.remove(box);
                }
            });
        });
        api.objectTracker.activateDataSet(id);
    });
});
// On first update event, set the scene center based on the initial user height 
app.updateEvent.onNext(function () {
    var userStagePose = app.context.getEntityPose(app.context.user, app.context.stage);
    var userHeightOnStage = userStagePose.position.y;
    center.position.y = userHeightOnStage;
});
// On every update event, update user and stage pose
app.updateEvent.addEventListener(function () {
    var userPose = app.context.getEntityPose(app.context.user);
    user.position.copy(userPose.position);
    user.quaternion.copy(userPose.orientation);
    var stagePose = app.context.getEntityPose(app.context.stage);
    stage.position.copy(stagePose.position);
    stage.quaternion.copy(stagePose.orientation);
});
app.renderEvent.addEventListener(function () {
    // css renderer, if used:
    // const viewport = app.view.viewport;
    // cssRenderer.setSize(viewport.width, viewport.height);
    renderer.setSize(app.view.renderWidth, app.view.renderHeight, false);
    for (var _i = 0, _a = app.view.subviews; _i < _a.length; _i++) {
        var subview = _a[_i];
        camera.position.copy(subview.pose.position);
        camera.quaternion.copy(subview.pose.orientation);
        camera.projectionMatrix.fromArray(subview.frustum.projectionMatrix);
        var _b = subview.renderViewport, x = _b.x, y = _b.y, width = _b.width, height = _b.height;
        renderer.setViewport(x, y, width, height);
        renderer.setScissor(x, y, width, height);
        renderer.setScissorTest(true);
        renderer.render(scene, camera);
        // let {x,y,width,height} = subview.viewport;
        // cssRenderer.setViewport(x,y,width,height, subview.index)
    }
});
// // creating 6 divs to indicate the x y z positioning
// const divXpos = document.createElement('div')
// const divXneg = document.createElement('div')
// const divYpos = document.createElement('div')
// const divYneg = document.createElement('div')
// const divZpos = document.createElement('div')
// const divZneg = document.createElement('div')
// // programatically create a stylesheet for our direction divs
// // and add it to the document
// const style = document.createElement("style");
// style.type = 'text/css';
// document.head.appendChild(style);
// const sheet = <CSSStyleSheet>style.sheet;
// sheet.insertRule(`
//     .direction {
//         opacity: 0.5;
//         width: 100px;
//         height: 100px;
//         border-radius: 50%;
//         line-height: 100px;
//         fontSize: 20px;
//         text-align: center;
//     }
// `, 0);
// // Put content in each one  (should do this as a couple of functions)
// // for X
// divXpos.className = 'direction'
// divXpos.style.backgroundColor = "red"
// divXpos.innerText = "Pos X = East"
// divXneg.className = 'direction'
// divXneg.style.backgroundColor = "red"
// divXneg.innerText = "Neg X = West"
// // for Y
// divYpos.className = 'direction'
// divYpos.style.backgroundColor = "blue"
// divYpos.innerText = "Pos Y = Up"
// divYneg.className = 'direction'
// divYneg.style.backgroundColor = "blue"
// divYneg.innerText = "Neg Y = Down"
// //for Z
// divZpos.className = 'direction'
// divZpos.style.backgroundColor = "green"
// divZpos.innerText = "Pos Z = South"
// divZneg.className = 'direction'
// divZneg.style.backgroundColor = "green"
// divZneg.innerText = "Neg Z = North"
// // create 6 CSS3DObjects in the scene graph
// const cssObjectXpos = new THREE.CSS3DObject(divXpos)
// const cssObjectXneg = new THREE.CSS3DObject(divXneg)
// const cssObjectYpos = new THREE.CSS3DObject(divYpos)
// const cssObjectYneg = new THREE.CSS3DObject(divYneg)
// const cssObjectZpos = new THREE.CSS3DObject(divZpos)
// const cssObjectZneg = new THREE.CSS3DObject(divZneg)
// // the width and height is used to align things.
// cssObjectXpos.position.x = 200.0
// cssObjectXpos.rotation.y = - Math.PI / 2
// cssObjectXneg.position.x = -200.0
// cssObjectXneg.rotation.y = Math.PI / 2
// // for Y
// cssObjectYpos.position.y = 200.0
// cssObjectYpos.rotation.x = Math.PI / 2
// cssObjectYneg.position.y = - 200.0
// cssObjectYneg.rotation.x = - Math.PI / 2
// // for Z
// cssObjectZpos.position.z = 200.0
// cssObjectZpos.rotation.y = Math.PI
// cssObjectZneg.position.z = -200.0
// //no rotation need for this one
// userLocation.add(cssObjectXpos)
// userLocation.add(cssObjectXneg)
// userLocation.add(cssObjectYpos)
// userLocation.add(cssObjectYneg)
// userLocation.add(cssObjectZpos)
// userLocation.add(cssObjectZneg)
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhhbXBsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImV4YW1wbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEtBQUssTUFBTSxpQkFBaUIsQ0FBQTtBQVN4QyxNQUFNLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDO0FBRXhCLElBQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7QUFFekMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsRUFBRSxDQUFDO0FBRW5DLElBQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNsRCxJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztBQUNoRSxJQUFNLElBQUksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7QUFDbkQsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksS0FBSyxDQUFDLFFBQVEsQ0FBQztBQUNuRCxJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUcsSUFBSSxLQUFLLENBQUMsUUFBUSxDQUFDO0FBRXJELEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDbEIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNoQixLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBRWpCLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFbEIsSUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLENBQUMsYUFBYSxDQUFDO0lBQ3JDLEtBQUssRUFBRSxJQUFJO0lBQ1gsc0JB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QUFFbkMsa0NBQWtDO0FBQ2xDLHlDQUF5QztBQUN6QyxxQ0FBcUM7QUFFckMsVUFBVTtBQUNWLGtDQUFrQztBQUNsQywwQ0FBMEM7QUFDMUMsc0NBQXNDO0FBRXRDLGtDQUFrQztBQUNsQywwQ0FBMEM7QUFDMUMsc0NBQXNDO0FBRXRDLDhDQUE4QztBQUM5Qyx1REFBdUQ7QUFDdkQsdURBQXVEO0FBQ3ZELHVEQUF1RDtBQUN2RCx1REFBdUQ7QUFDdkQsdURBQXVEO0FBQ3ZELHVEQUF1RDtBQUV2RCxtREFBbUQ7QUFDbkQsbUNBQW1DO0FBQ25DLDJDQUEyQztBQUUzQyxvQ0FBb0M7QUFDcEMseUNBQXlDO0FBRXpDLFdBQVc7QUFDWCxtQ0FBbUM7QUFDbkMseUNBQXlDO0FBRXpDLHFDQUFxQztBQUNyQywyQ0FBMkM7QUFFM0MsV0FBVztBQUNYLG1DQUFtQztBQUNuQyxxQ0FBcUM7QUFFckMsb0NBQW9DO0FBQ3BDLGtDQUFrQztBQUVsQyxrQ0FBa0M7QUFDbEMsa0NBQWtDO0FBQ2xDLGtDQUFrQztBQUNsQyxrQ0FBa0M7QUFDbEMsa0NBQWtDO0FBQ2xDLGtDQUFrQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEFyZ29uIGZyb20gJy4uLy4uL3NyYy9hcmdvbidcbi8vIGltcG9ydCAqIGFzIEFyZ29uIGZyb20gJ0BhcmdvbmpzL2FyZ29uJ1xuLy8gaW1wb3J0ICogYXMgQXJnb24gZnJvbSAnLi4vZGlzdC9zcmMvYXJnb24nXG5cbmltcG9ydCBfX1RIUkVFIGZyb20gJ3RocmVlJztcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgY29uc3QgVEhSRUU6IHR5cGVvZiBfX1RIUkVFO1xufVxuXG53aW5kb3dbJ0FyZ29uJ10gPSBBcmdvbjtcblxuY29uc3QgYXBwID0gd2luZG93WydhcHAnXSA9IEFyZ29uLmluaXQoKTtcblxuYXBwLmNvbnRleHQuc3Vic2NyaWJlR2VvbG9jYXRpb24oKTtcblxuY29uc3Qgc2NlbmUgPSB3aW5kb3dbJ3NjZW5lJ10gPSBuZXcgVEhSRUUuU2NlbmUoKTtcbmNvbnN0IGNhbWVyYSA9IHdpbmRvd1snY2FtZXJhJ10gPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoKTtcbmNvbnN0IHVzZXIgPSB3aW5kb3dbJ3VzZXInXSA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuY29uc3Qgc3RhZ2UgPSB3aW5kb3dbJ3N0YWdlJ10gPSBuZXcgVEhSRUUuT2JqZWN0M0Q7XG5jb25zdCBjZW50ZXIgPSB3aW5kb3dbJ2NlbnRlciddID0gbmV3IFRIUkVFLk9iamVjdDNEO1xuXG5zY2VuZS5hZGQoY2FtZXJhKTtcbnNjZW5lLmFkZCh1c2VyKTtcbnNjZW5lLmFkZChzdGFnZSk7XG5cbnN0YWdlLmFkZChjZW50ZXIpOyBcblxuY29uc3QgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7IFxuICAgIGFscGhhOiB0cnVlLCBcbiAgICBsb2dhcml0aG1pY0RlcHRoQnVmZmVyOiB0cnVlXG59KTtcblxuYXBwLnZpZXcuc2V0TGF5ZXJzKFtcbiAgICB7c291cmNlOiByZW5kZXJlci5kb21FbGVtZW50fVxuXSk7XG5cbmNvbnN0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KCAwLjEsIDMyLCAzMiApO1xuXG5sZXQgbWF0ID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7Y29sb3I6IDB4ZmYwMDAwfSApO1xuXG5jb25zdCBwb3NYU3BoZXJlID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXQgKTtcbnBvc1hTcGhlcmUucG9zaXRpb24ueCA9IDE7XG5jZW50ZXIuYWRkKCBwb3NYU3BoZXJlICk7XG5cbm1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCgge2NvbG9yOiAweGZmYWFhYX0gKTtcblxuY29uc3QgbmVnWFNwaGVyZSA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ICk7XG5uZWdYU3BoZXJlLnBvc2l0aW9uLnggPSAtMTtcbmNlbnRlci5hZGQoIG5lZ1hTcGhlcmUgKTtcblxubWF0ID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7Y29sb3I6IDB4MDBmZjAwfSApO1xuXG5jb25zdCBwb3NZU3BoZXJlID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXQgKTtcbnBvc1lTcGhlcmUucG9zaXRpb24ueSA9IDE7XG5jZW50ZXIuYWRkKCBwb3NZU3BoZXJlICk7XG5cbm1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCgge2NvbG9yOiAweGFhZmZhYX0gKTtcblxuY29uc3QgbmVnWVNwaGVyZSA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ICk7XG5uZWdZU3BoZXJlLnBvc2l0aW9uLnkgPSAtMTtcbmNlbnRlci5hZGQoIG5lZ1lTcGhlcmUgKTtcblxubWF0ID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7Y29sb3I6IDB4MDAwMGZmfSApO1xuXG5jb25zdCBwb3NaU3BoZXJlID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXQgKTtcbnBvc1pTcGhlcmUucG9zaXRpb24ueiA9IDE7XG5jZW50ZXIuYWRkKCBwb3NaU3BoZXJlICk7XG5cbm1hdCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCgge2NvbG9yOiAweGFhYWFmZn0gKTtcblxuY29uc3QgbmVnWlNwaGVyZSA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ICk7XG5uZWdaU3BoZXJlLnBvc2l0aW9uLnogPSAtMTtcbmNlbnRlci5hZGQoIG5lZ1pTcGhlcmUgKTtcblxuICAgICAgICAgICAgXG52YXIgYXhpc0hlbHBlciA9IG5ldyBUSFJFRS5BeGlzSGVscGVyKCAwLjEgKTtcbmNlbnRlci5hZGQoIGF4aXNIZWxwZXIgKTtcblxuLy8gdmFyIHRleHRTaGFwZXMgPSBUSFJFRS5Gb250VXRpbHMuZ2VuZXJhdGVTaGFwZXMoIFwiUG9zWlwiLCBvcHRpb25zICk7XG4vLyB2YXIgdGV4dCA9IG5ldyBUSFJFRS5TaGFwZUdlb21ldHJ5KCB0ZXh0U2hhcGVzICk7XG4vLyB2YXIgdGV4dE1lc2ggPSBuZXcgVEhSRUUuTWVzaCggdGV4dCwgbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7IGNvbG9yOiAweGZmMDAwMCB9ICkgKSA7XG4vLyBzY2VuZS5hZGQodGV4dE1lc2gpO1xuXG5hcHAudnVmb3JpYS5pbml0KHtcbmVuY3J5cHRlZExpY2Vuc2VEYXRhOiBgLS0tLS1CRUdJTiBQR1AgTUVTU0FHRS0tLS0tXG5Db21tZW50OiBHUEdUb29scyAtIGh0dHBzOi8vZ3BndG9vbHMub3JnXG5cbmhRSU1BMUFVUUNOZG04bGhBUS8rS2FtNm5hVEdwbzZDMkVrWU9XVEtWbWVMYTZsRDRlcGFSckgzWm5oT0htNXpcbmRwRm1UZWh4ZStBL0ovNy82OEV2RUdEUGZ1VjRjcUhUWE51dmxBdlkxSzYyNS9pOEVmTnJ4K25QTDB1bWFwNUVcbldhWVJuTE5GNk1sQzFQdThhTFk4Yzh2ZC9aQTloMlprOFA0dDBDL3VPYXlKQlprMEJoS1JsT2dDSmJqT2Q3L1hcbkVNUE9EM1h0RlVQOFQxM0twcWIvQThjeUlSVE9vd204eWFqNFBhalVDQWxPV1NZS1lSY1hNNXlnLzV0N1hUZGlcbjNpVVJnaWRGYldvd2JucXlGbU9LeEF4cVJCb1hQR1lFRG1LOElnT2dZbVI3QzVwVkFtV0RLOFpjc1RuMllDMFRcbkpoWVVTUXZSQTJDc3pLOVVNRW9PaDJycUU4UkhaWTRNdVZQbTFRTkMxajR5UDFGU0RadmZjSmRPVGJUZUJDY2lcbjZBVENBUm1hK3JvQTN4dGJ6UFZXaGpjOERHdGxSSUpxajArY1JqSzhSTXpJTWJCUEdsVFppaGd0N1cwc2lmYS9cbm0zOHpBbEU0QmU1T21nK2tKNzZreVhwaCtTSWowZ3FCbDVyRzM0TzRuNEtnQ0Jvb2lwalduQWZ6d0tKa25CaVhcbjc0ZXg5OUxaZi9WZmlqQ2pES2tVcGl5ckhIT2tXSEZEZW9sV1RaVm1qM0Q2SEJxVWFDTUdwM09iUTBBR0ErdHRcbi9CdVJvaElIazF6dlNUNjZGekJvRngyK2ZjdFptN2MrVkl0QW95Vy8rSVZ1dWxGQ3NvUWRFNTlmRjgxTWFNYW5cblJ3MU1OQzZkMXVlbUlaSS94cCtpbHhicGVsb3lweXJXYTZaTHpsU2NPdjcvL0M1Ym93WmdqbXhDZmJZN1NZSFNcbjZRRnlVbGxjS0lZR29WT01YMzBacmRhUU1VODE3N25uTWlrOEl2cjV6a2d1OUZzS2t3aTBNSDRYVFA0SnA4emtcbmVSNGYrYnpabXhpdFRMWW9hSkZua214ZHp5SFRzSVhnT090bmRUaDE4K3VTZ3ZFeitvZXdydmF3UUNUWEpLWHdcbkJ3WWs3d0F2TWxGeXdNTS9CK0g0a3ZCT1RocUc3amUyUzNVaXRXMXdhbFN3cStQOHAvdjJVekl4eSt5R1R6bHpcbjBlS21mYngyYjIrNnI3NmhEVlJ0MFhpQXVWS1hxOEVybmR4MjBWa1JaajNNQk9ndXMzWG12YkNnT1JuMHc1Ri9cbjJzZzZra05EckFJN2FVcTgzRUZNdURyM0E2QUJidDNDNmNFUEVCMXNMaHNxaG5MVHZrSFRyNko3QnIrd0krMmZcbmVsVDN4MTVvUFVBam5EUVI3a0M3N2NtWjhVNW8vUjJuWU9sUHpEU3lYMzRjVjN6MTc2aHFzc1FhM2wvZWJoKzRcbnV1TUhpZWN1dC9zMkZWQUNyaXpWdEVJK1o5STczaVVSd0Q5RHJkUnVKS1lNZEtvWURxb000M1ZkSVpmTmMzRWNcbmo3U0tDL0xTcE9KTDhZUWxMb0tMdGRBakNZclloRGd5Y0FLS3BUdzlLdjZ3YlNRM3F4T0VVTXJ4SzJJMzBOYUFcbjl0dXpmMTVXWitUYXRoR1RJTDdWcUxLUzRVUEs1N3p2cmRxbmVCNlhsajRDQUJNSUwzWm1nR3VKUHI4V1NKU3VcbnhNVFhCb3dxQzRlTnV3VUd0UXRzeSs3eFlreE9Mcy9OVm4ybk5OYjZObEVhWlgwUVVocWdXK3Q1ajNkNFNScnlcbmtEWVpJYnErUnFQd2FaaGcwaFhwVDVGd3o5N3k0WjVOeWpBdTQ0a2lZQUsyRHUwVnlpMWUwUE10VzJqYTRaSDBcbj1kK29HXG4tLS0tLUVORCBQR1AgTUVTU0FHRS0tLS0tYFxufSkudGhlbigoYXBpKT0+e1xuICAgIGFwaS5vYmplY3RUcmFja2VyLmNyZWF0ZURhdGFTZXRGcm9tVVJMKCdkYXRhc2V0L1N0b25lc0FuZENoaXBzLnhtbCcpLnRoZW4oIChpZCk9PntcblxuICAgICAgICBhcGkub2JqZWN0VHJhY2tlci5sb2FkRGF0YVNldChpZCkudGhlbigodHJhY2thYmxlcyk9PntcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3Qgc3RvbmVzRW50aXR5ID0gYXBwLmNvbnRleHQuc3Vic2NyaWJlVG9FbnRpdHlCeUlkKHRyYWNrYWJsZXNbJ3N0b25lcyddLmlkKVxuICAgICAgICAgICAgY29uc3Qgc3RvbmVzT2JqZWN0ID0gbmV3IFRIUkVFLk9iamVjdDNEO1xuICAgICAgICAgICAgc2NlbmUuYWRkKHN0b25lc09iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBib3hHZW9tZXRyeSA9IG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSg1MCwgNTAsIDUwKTtcbiAgICAgICAgICAgIHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoTm9ybWFsTWF0ZXJpYWwoKVxuICAgICAgICAgICAgbWF0ZXJpYWwuc2lkZSA9IFRIUkVFLkRvdWJsZVNpZGU7XG4gICAgICAgICAgICBjb25zdCBib3ggPSBuZXcgVEhSRUUuTWVzaChib3hHZW9tZXRyeSwgbWF0ZXJpYWwpO1xuICAgICAgICAgICAgYm94LnBvc2l0aW9uLnogPSAyNTtcbiAgICAgICAgICAgIGJveC5wb3NpdGlvbi55ID0gNTA7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBheGlzSGVscGVyID0gbmV3IFRIUkVFLkF4aXNIZWxwZXIoIDEwICk7XG4gICAgICAgICAgICBib3guYWRkKCBheGlzSGVscGVyICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWJzY3JpYmVzIHRvIHN0b25lcyB0cmFja2FibGUgd2l0aCBpZCAnICsgdHJhY2thYmxlc1snc3RvbmVzJ10uaWQpO1xuXG4gICAgICAgICAgICBhcHAuY29udGV4dC51cGRhdGVFdmVudC5hZGRFdmVudExpc3RlbmVyKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdG9uZXNQb3NlID0gYXBwLmNvbnRleHQuZ2V0RW50aXR5UG9zZShzdG9uZXNFbnRpdHkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN0b25lc1Bvc2Uuc3RhdHVzICYgQXJnb24uUG9zZVN0YXR1cy5LTk9XTikge1xuICAgICAgICAgICAgICAgICAgICBzdG9uZXNPYmplY3QucG9zaXRpb24uY29weSg8YW55PnN0b25lc1Bvc2UucG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBzdG9uZXNPYmplY3QucXVhdGVybmlvbi5jb3B5KDxhbnk+c3RvbmVzUG9zZS5vcmllbnRhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHN0b25lc09iamVjdC5hZGQoYm94KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdG9uZXNPYmplY3QucmVtb3ZlKGJveCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBhcGkub2JqZWN0VHJhY2tlci5hY3RpdmF0ZURhdGFTZXQoaWQpO1xuICAgIH0pO1xufSlcblxuLy8gT24gZmlyc3QgdXBkYXRlIGV2ZW50LCBzZXQgdGhlIHNjZW5lIGNlbnRlciBiYXNlZCBvbiB0aGUgaW5pdGlhbCB1c2VyIGhlaWdodCBcbmFwcC51cGRhdGVFdmVudC5vbk5leHQoKCk9PntcbiAgICBjb25zdCB1c2VyU3RhZ2VQb3NlID0gYXBwLmNvbnRleHQuZ2V0RW50aXR5UG9zZShhcHAuY29udGV4dC51c2VyLCBhcHAuY29udGV4dC5zdGFnZSk7XG4gICAgY29uc3QgdXNlckhlaWdodE9uU3RhZ2UgPSB1c2VyU3RhZ2VQb3NlLnBvc2l0aW9uLnk7XG4gICAgY2VudGVyLnBvc2l0aW9uLnkgPSB1c2VySGVpZ2h0T25TdGFnZTtcbn0pXG5cbi8vIE9uIGV2ZXJ5IHVwZGF0ZSBldmVudCwgdXBkYXRlIHVzZXIgYW5kIHN0YWdlIHBvc2VcbmFwcC51cGRhdGVFdmVudC5hZGRFdmVudExpc3RlbmVyKCgpID0+IHtcbiAgICBjb25zdCB1c2VyUG9zZSA9IGFwcC5jb250ZXh0LmdldEVudGl0eVBvc2UoYXBwLmNvbnRleHQudXNlcik7XG4gICAgdXNlci5wb3NpdGlvbi5jb3B5KDxhbnk+dXNlclBvc2UucG9zaXRpb24pO1xuICAgIHVzZXIucXVhdGVybmlvbi5jb3B5KDxhbnk+dXNlclBvc2Uub3JpZW50YXRpb24pO1xuXG4gICAgY29uc3Qgc3RhZ2VQb3NlID0gYXBwLmNvbnRleHQuZ2V0RW50aXR5UG9zZShhcHAuY29udGV4dC5zdGFnZSk7XG4gICAgc3RhZ2UucG9zaXRpb24uY29weSg8YW55PnN0YWdlUG9zZS5wb3NpdGlvbik7XG4gICAgc3RhZ2UucXVhdGVybmlvbi5jb3B5KDxhbnk+c3RhZ2VQb3NlLm9yaWVudGF0aW9uKTtcbn0pO1xuXG5hcHAucmVuZGVyRXZlbnQuYWRkRXZlbnRMaXN0ZW5lcigoKSA9PiB7XG4gICAgLy8gY3NzIHJlbmRlcmVyLCBpZiB1c2VkOlxuICAgIC8vIGNvbnN0IHZpZXdwb3J0ID0gYXBwLnZpZXcudmlld3BvcnQ7XG4gICAgLy8gY3NzUmVuZGVyZXIuc2V0U2l6ZSh2aWV3cG9ydC53aWR0aCwgdmlld3BvcnQuaGVpZ2h0KTtcblxuICAgIHJlbmRlcmVyLnNldFNpemUoYXBwLnZpZXcucmVuZGVyV2lkdGgsIGFwcC52aWV3LnJlbmRlckhlaWdodCwgZmFsc2UpO1xuICAgIFxuICAgIGZvciAobGV0IHN1YnZpZXcgb2YgYXBwLnZpZXcuc3Vidmlld3MpIHtcbiAgICAgICAgY2FtZXJhLnBvc2l0aW9uLmNvcHkoPGFueT5zdWJ2aWV3LnBvc2UucG9zaXRpb24pO1xuICAgICAgICBjYW1lcmEucXVhdGVybmlvbi5jb3B5KDxhbnk+c3Vidmlldy5wb3NlLm9yaWVudGF0aW9uKTtcbiAgICAgICAgY2FtZXJhLnByb2plY3Rpb25NYXRyaXguZnJvbUFycmF5KDxhbnk+c3Vidmlldy5mcnVzdHVtLnByb2plY3Rpb25NYXRyaXgpO1xuXG4gICAgICAgIGxldCB7eCx5LHdpZHRoLGhlaWdodH0gPSBzdWJ2aWV3LnJlbmRlclZpZXdwb3J0O1xuICAgICAgICByZW5kZXJlci5zZXRWaWV3cG9ydCh4LHksd2lkdGgsaGVpZ2h0KTtcbiAgICAgICAgcmVuZGVyZXIuc2V0U2Npc3Nvcih4LHksd2lkdGgsaGVpZ2h0KTtcbiAgICAgICAgcmVuZGVyZXIuc2V0U2Npc3NvclRlc3QodHJ1ZSk7XG4gICAgICAgIHJlbmRlcmVyLnJlbmRlcihzY2VuZSwgY2FtZXJhKTtcblxuICAgICAgICAvLyBsZXQge3gseSx3aWR0aCxoZWlnaHR9ID0gc3Vidmlldy52aWV3cG9ydDtcbiAgICAgICAgLy8gY3NzUmVuZGVyZXIuc2V0Vmlld3BvcnQoeCx5LHdpZHRoLGhlaWdodCwgc3Vidmlldy5pbmRleClcbiAgICB9XG59KVxuXG4vLyAvLyBjcmVhdGluZyA2IGRpdnMgdG8gaW5kaWNhdGUgdGhlIHggeSB6IHBvc2l0aW9uaW5nXG4vLyBjb25zdCBkaXZYcG9zID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcbi8vIGNvbnN0IGRpdlhuZWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuLy8gY29uc3QgZGl2WXBvcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4vLyBjb25zdCBkaXZZbmVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jylcbi8vIGNvbnN0IGRpdlpwb3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuLy8gY29uc3QgZGl2Wm5lZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbi8vIC8vIHByb2dyYW1hdGljYWxseSBjcmVhdGUgYSBzdHlsZXNoZWV0IGZvciBvdXIgZGlyZWN0aW9uIGRpdnNcbi8vIC8vIGFuZCBhZGQgaXQgdG8gdGhlIGRvY3VtZW50XG4vLyBjb25zdCBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcbi8vIHN0eWxlLnR5cGUgPSAndGV4dC9jc3MnO1xuLy8gZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XG4vLyBjb25zdCBzaGVldCA9IDxDU1NTdHlsZVNoZWV0PnN0eWxlLnNoZWV0O1xuLy8gc2hlZXQuaW5zZXJ0UnVsZShgXG4vLyAgICAgLmRpcmVjdGlvbiB7XG4vLyAgICAgICAgIG9wYWNpdHk6IDAuNTtcbi8vICAgICAgICAgd2lkdGg6IDEwMHB4O1xuLy8gICAgICAgICBoZWlnaHQ6IDEwMHB4O1xuLy8gICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7XG4vLyAgICAgICAgIGxpbmUtaGVpZ2h0OiAxMDBweDtcbi8vICAgICAgICAgZm9udFNpemU6IDIwcHg7XG4vLyAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbi8vICAgICB9XG4vLyBgLCAwKTtcblxuLy8gLy8gUHV0IGNvbnRlbnQgaW4gZWFjaCBvbmUgIChzaG91bGQgZG8gdGhpcyBhcyBhIGNvdXBsZSBvZiBmdW5jdGlvbnMpXG4vLyAvLyBmb3IgWFxuLy8gZGl2WHBvcy5jbGFzc05hbWUgPSAnZGlyZWN0aW9uJ1xuLy8gZGl2WHBvcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiXG4vLyBkaXZYcG9zLmlubmVyVGV4dCA9IFwiUG9zIFggPSBFYXN0XCJcblxuLy8gZGl2WG5lZy5jbGFzc05hbWUgPSAnZGlyZWN0aW9uJ1xuLy8gZGl2WG5lZy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiXG4vLyBkaXZYbmVnLmlubmVyVGV4dCA9IFwiTmVnIFggPSBXZXN0XCJcblxuLy8gLy8gZm9yIFlcbi8vIGRpdllwb3MuY2xhc3NOYW1lID0gJ2RpcmVjdGlvbidcbi8vIGRpdllwb3Muc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJibHVlXCJcbi8vIGRpdllwb3MuaW5uZXJUZXh0ID0gXCJQb3MgWSA9IFVwXCJcblxuLy8gZGl2WW5lZy5jbGFzc05hbWUgPSAnZGlyZWN0aW9uJ1xuLy8gZGl2WW5lZy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImJsdWVcIlxuLy8gZGl2WW5lZy5pbm5lclRleHQgPSBcIk5lZyBZID0gRG93blwiXG5cbi8vIC8vZm9yIFpcbi8vIGRpdlpwb3MuY2xhc3NOYW1lID0gJ2RpcmVjdGlvbidcbi8vIGRpdlpwb3Muc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJncmVlblwiXG4vLyBkaXZacG9zLmlubmVyVGV4dCA9IFwiUG9zIFogPSBTb3V0aFwiXG5cbi8vIGRpdlpuZWcuY2xhc3NOYW1lID0gJ2RpcmVjdGlvbidcbi8vIGRpdlpuZWcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJncmVlblwiXG4vLyBkaXZabmVnLmlubmVyVGV4dCA9IFwiTmVnIFogPSBOb3J0aFwiXG5cbi8vIC8vIGNyZWF0ZSA2IENTUzNET2JqZWN0cyBpbiB0aGUgc2NlbmUgZ3JhcGhcbi8vIGNvbnN0IGNzc09iamVjdFhwb3MgPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoZGl2WHBvcylcbi8vIGNvbnN0IGNzc09iamVjdFhuZWcgPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoZGl2WG5lZylcbi8vIGNvbnN0IGNzc09iamVjdFlwb3MgPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoZGl2WXBvcylcbi8vIGNvbnN0IGNzc09iamVjdFluZWcgPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoZGl2WW5lZylcbi8vIGNvbnN0IGNzc09iamVjdFpwb3MgPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoZGl2WnBvcylcbi8vIGNvbnN0IGNzc09iamVjdFpuZWcgPSBuZXcgVEhSRUUuQ1NTM0RPYmplY3QoZGl2Wm5lZylcblxuLy8gLy8gdGhlIHdpZHRoIGFuZCBoZWlnaHQgaXMgdXNlZCB0byBhbGlnbiB0aGluZ3MuXG4vLyBjc3NPYmplY3RYcG9zLnBvc2l0aW9uLnggPSAyMDAuMFxuLy8gY3NzT2JqZWN0WHBvcy5yb3RhdGlvbi55ID0gLSBNYXRoLlBJIC8gMlxuXG4vLyBjc3NPYmplY3RYbmVnLnBvc2l0aW9uLnggPSAtMjAwLjBcbi8vIGNzc09iamVjdFhuZWcucm90YXRpb24ueSA9IE1hdGguUEkgLyAyXG5cbi8vIC8vIGZvciBZXG4vLyBjc3NPYmplY3RZcG9zLnBvc2l0aW9uLnkgPSAyMDAuMFxuLy8gY3NzT2JqZWN0WXBvcy5yb3RhdGlvbi54ID0gTWF0aC5QSSAvIDJcblxuLy8gY3NzT2JqZWN0WW5lZy5wb3NpdGlvbi55ID0gLSAyMDAuMFxuLy8gY3NzT2JqZWN0WW5lZy5yb3RhdGlvbi54ID0gLSBNYXRoLlBJIC8gMlxuXG4vLyAvLyBmb3IgWlxuLy8gY3NzT2JqZWN0WnBvcy5wb3NpdGlvbi56ID0gMjAwLjBcbi8vIGNzc09iamVjdFpwb3Mucm90YXRpb24ueSA9IE1hdGguUElcblxuLy8gY3NzT2JqZWN0Wm5lZy5wb3NpdGlvbi56ID0gLTIwMC4wXG4vLyAvL25vIHJvdGF0aW9uIG5lZWQgZm9yIHRoaXMgb25lXG5cbi8vIHVzZXJMb2NhdGlvbi5hZGQoY3NzT2JqZWN0WHBvcylcbi8vIHVzZXJMb2NhdGlvbi5hZGQoY3NzT2JqZWN0WG5lZylcbi8vIHVzZXJMb2NhdGlvbi5hZGQoY3NzT2JqZWN0WXBvcylcbi8vIHVzZXJMb2NhdGlvbi5hZGQoY3NzT2JqZWN0WW5lZylcbi8vIHVzZXJMb2NhdGlvbi5hZGQoY3NzT2JqZWN0WnBvcylcbi8vIHVzZXJMb2NhdGlvbi5hZGQoY3NzT2JqZWN0Wm5lZylcbiJdfQ==